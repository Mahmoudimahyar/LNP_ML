Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 5,
 'features_generator': None,
 'features_only': False,
 'features_path': 'Data/Multitask_data/All_datasets/Splits/train_extra_x.csv',
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/trained_model/fold_0',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': 'Data/Multitask_data/All_datasets/Splits/test_extra_x.csv',
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/test.csv',
 'separate_val_features_path': 'Data/Multitask_data/All_datasets/Splits/valid_extra_x.csv',
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 5,
 'features_generator': None,
 'features_only': False,
 'features_path': 'Data/Multitask_data/All_datasets/Splits/train_extra_x.csv',
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/trained_model/fold_0',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': 'Data/Multitask_data/All_datasets/Splits/test_extra_x.csv',
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/test.csv',
 'separate_val_features_path': 'Data/Multitask_data/All_datasets/Splits/valid_extra_x.csv',
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 5,
 'features_generator': None,
 'features_only': False,
 'features_path': 'Data/Multitask_data/All_datasets/Splits/train_extra_x.csv',
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': 'Data/Multitask_data/All_datasets/Splits/test_extra_x.csv',
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/test.csv',
 'separate_val_features_path': 'Data/Multitask_data/All_datasets/Splits/valid_extra_x.csv',
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 5,
 'features_generator': None,
 'features_only': False,
 'features_path': 'Data/Multitask_data/All_datasets/Splits/train_extra_x.csv',
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': 'Data/Multitask_data/All_datasets/Splits/test_extra_x.csv',
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/test.csv',
 'separate_val_features_path': 'Data/Multitask_data/All_datasets/Splits/valid_extra_x.csv',
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 5,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 5,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 3
Splitting data with seed 5
Total size = 1,804 | train size = 1,804 | val size = 602 | test size = 602
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=305, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 357,003
Epoch 0
Loss = 2.3602e-02, PNorm = 34.0589, GNorm = 1.0924, lr_0 = 2.3750e-04
Loss = 1.6343e-02, PNorm = 34.0675, GNorm = 2.4506, lr_0 = 3.6250e-04
Loss = 1.6998e-02, PNorm = 34.0792, GNorm = 3.3745, lr_0 = 4.8750e-04
Validation rmse = 0.509946
Epoch 1
Loss = 1.8764e-02, PNorm = 34.0948, GNorm = 2.1426, lr_0 = 6.1250e-04
Loss = 1.6177e-02, PNorm = 34.1155, GNorm = 1.3873, lr_0 = 7.3750e-04
Loss = 1.4825e-02, PNorm = 34.1407, GNorm = 1.9085, lr_0 = 8.6250e-04
Loss = 1.3663e-02, PNorm = 34.1623, GNorm = 1.5441, lr_0 = 9.8750e-04
Validation rmse = 0.514961
Epoch 2
Loss = 1.5686e-02, PNorm = 34.1907, GNorm = 4.7482, lr_0 = 8.2540e-04
Loss = 1.5335e-02, PNorm = 34.2127, GNorm = 1.7151, lr_0 = 6.6692e-04
Loss = 1.5821e-02, PNorm = 34.2317, GNorm = 2.9656, lr_0 = 5.3887e-04
Validation rmse = 0.478838
Epoch 3
Loss = 1.4632e-02, PNorm = 34.2494, GNorm = 0.8408, lr_0 = 4.3540e-04
Loss = 1.3421e-02, PNorm = 34.2630, GNorm = 1.0093, lr_0 = 3.5180e-04
Loss = 1.4362e-02, PNorm = 34.2782, GNorm = 0.9221, lr_0 = 2.8425e-04
Loss = 1.5389e-02, PNorm = 34.2893, GNorm = 1.1929, lr_0 = 2.2967e-04
Validation rmse = 0.475761
Epoch 4
Loss = 1.5037e-02, PNorm = 34.2994, GNorm = 2.0821, lr_0 = 1.8557e-04
Loss = 1.3940e-02, PNorm = 34.3066, GNorm = 2.4059, lr_0 = 1.4994e-04
Loss = 1.4472e-02, PNorm = 34.3134, GNorm = 2.5603, lr_0 = 1.2115e-04
Loss = 1.2101e-02, PNorm = 34.3197, GNorm = 1.7918, lr_0 = 1.0000e-04
Validation rmse = 0.485274
Model 0 best validation rmse = 0.475761 on epoch 3
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.474726
Ensemble test rmse = 0.474726
1-fold cross validation
Seed 5 ==> test rmse = 0.474726
Overall test rmse = 0.474726 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 5,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/trained_model/fold_0',
 'save_smiles_splits': True,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 3
Splitting data with seed 5
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 5,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 3
Splitting data with seed 5
Total size = 1,804 | train size = 1,804 | val size = 602 | test size = 602
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=305, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 357,003
Epoch 0
Loss = 1.8689e-02, PNorm = 34.0239, GNorm = 1.5950, lr_0 = 2.3750e-04
Loss = 1.7695e-02, PNorm = 34.0319, GNorm = 0.9121, lr_0 = 3.6250e-04
Loss = 1.7664e-02, PNorm = 34.0495, GNorm = 1.5730, lr_0 = 4.8750e-04
Validation rmse = 0.507708
Epoch 1
Loss = 1.4956e-02, PNorm = 34.0621, GNorm = 1.4551, lr_0 = 6.1250e-04
Loss = 1.6145e-02, PNorm = 34.0877, GNorm = 1.3228, lr_0 = 7.3750e-04
Loss = 1.6277e-02, PNorm = 34.1176, GNorm = 3.6220, lr_0 = 8.6250e-04
Loss = 1.5403e-02, PNorm = 34.1473, GNorm = 1.8158, lr_0 = 9.8750e-04
Validation rmse = 0.523396
Epoch 2
Loss = 1.2558e-02, PNorm = 34.1895, GNorm = 1.0354, lr_0 = 8.2540e-04
Loss = 1.7798e-02, PNorm = 34.2151, GNorm = 1.5001, lr_0 = 6.6692e-04
Loss = 1.5624e-02, PNorm = 34.2389, GNorm = 0.6436, lr_0 = 5.3887e-04
Validation rmse = 0.491254
Epoch 3
Loss = 1.4553e-02, PNorm = 34.2584, GNorm = 1.4566, lr_0 = 4.3540e-04
Loss = 1.6532e-02, PNorm = 34.2714, GNorm = 1.5608, lr_0 = 3.5180e-04
Loss = 1.3033e-02, PNorm = 34.2860, GNorm = 1.5029, lr_0 = 2.8425e-04
Loss = 1.2890e-02, PNorm = 34.2948, GNorm = 1.2397, lr_0 = 2.2967e-04
Validation rmse = 0.472804
Epoch 4
Loss = 1.4150e-02, PNorm = 34.3018, GNorm = 0.8231, lr_0 = 1.8557e-04
Loss = 1.3366e-02, PNorm = 34.3079, GNorm = 1.3895, lr_0 = 1.4994e-04
Loss = 1.5357e-02, PNorm = 34.3140, GNorm = 1.3040, lr_0 = 1.2115e-04
Loss = 1.1624e-02, PNorm = 34.3199, GNorm = 0.9804, lr_0 = 1.0000e-04
Validation rmse = 0.468589
Model 0 best validation rmse = 0.468589 on epoch 4
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.464868
Ensemble test rmse = 0.464868
1-fold cross validation
Seed 5 ==> test rmse = 0.464868
Overall test rmse = 0.464868 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 5,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 3
Splitting data with seed 5
Total size = 1,804 | train size = 1,804 | val size = 602 | test size = 602
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=310, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 358,503
Epoch 0
Loss = 1.7406e-02, PNorm = 34.0981, GNorm = 2.2941, lr_0 = 2.3750e-04
Loss = 2.0204e-02, PNorm = 34.1074, GNorm = 2.7544, lr_0 = 3.6250e-04
Loss = 1.6630e-02, PNorm = 34.1199, GNorm = 2.5265, lr_0 = 4.8750e-04
Validation rmse = 0.485149
Epoch 1
Loss = 1.9546e-02, PNorm = 34.1369, GNorm = 3.4231, lr_0 = 6.1250e-04
Loss = 1.5921e-02, PNorm = 34.1577, GNorm = 5.2184, lr_0 = 7.3750e-04
Loss = 1.5852e-02, PNorm = 34.1758, GNorm = 4.0322, lr_0 = 8.6250e-04
Loss = 1.3355e-02, PNorm = 34.1981, GNorm = 1.5659, lr_0 = 9.8750e-04
Validation rmse = 0.507178
Epoch 2
Loss = 1.5535e-02, PNorm = 34.2339, GNorm = 1.5439, lr_0 = 8.2540e-04
Loss = 1.5373e-02, PNorm = 34.2645, GNorm = 1.8173, lr_0 = 6.6692e-04
Loss = 1.2330e-02, PNorm = 34.2759, GNorm = 0.7738, lr_0 = 5.3887e-04
Validation rmse = 0.465802
Epoch 3
Loss = 1.4009e-02, PNorm = 34.2919, GNorm = 1.1462, lr_0 = 4.3540e-04
Loss = 1.3184e-02, PNorm = 34.3052, GNorm = 1.2803, lr_0 = 3.5180e-04
Loss = 1.4054e-02, PNorm = 34.3168, GNorm = 1.0351, lr_0 = 2.8425e-04
Loss = 1.3991e-02, PNorm = 34.3263, GNorm = 1.0280, lr_0 = 2.2967e-04
Validation rmse = 0.457575
Epoch 4
Loss = 1.4807e-02, PNorm = 34.3375, GNorm = 2.2328, lr_0 = 1.8557e-04
Loss = 1.1348e-02, PNorm = 34.3491, GNorm = 1.1596, lr_0 = 1.4994e-04
Loss = 1.4638e-02, PNorm = 34.3532, GNorm = 1.8320, lr_0 = 1.2115e-04
Loss = 1.3260e-02, PNorm = 34.3561, GNorm = 2.2369, lr_0 = 1.0000e-04
Validation rmse = 0.461781
Model 0 best validation rmse = 0.457575 on epoch 3
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.453274
Ensemble test rmse = 0.453274
1-fold cross validation
Seed 5 ==> test rmse = 0.453274
Overall test rmse = 0.453274 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 40,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 3
Splitting data with seed 5
Total size = 1,804 | train size = 1,804 | val size = 602 | test size = 602
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=310, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 358,503
Epoch 0
Loss = 1.9301e-02, PNorm = 34.0442, GNorm = 3.8130, lr_0 = 2.3750e-04
Loss = 1.8201e-02, PNorm = 34.0518, GNorm = 4.3555, lr_0 = 3.6250e-04
Loss = 1.4750e-02, PNorm = 34.0661, GNorm = 4.6181, lr_0 = 4.8750e-04
Validation rmse = 0.524464
Epoch 1
Loss = 1.7035e-02, PNorm = 34.0837, GNorm = 1.8547, lr_0 = 6.1250e-04
Loss = 1.4725e-02, PNorm = 34.1021, GNorm = 1.5235, lr_0 = 7.3750e-04
Loss = 1.7160e-02, PNorm = 34.1329, GNorm = 1.4347, lr_0 = 8.6250e-04
Loss = 1.4949e-02, PNorm = 34.1491, GNorm = 2.4873, lr_0 = 9.8750e-04
Validation rmse = 0.481610
Epoch 2
Loss = 1.5759e-02, PNorm = 34.1771, GNorm = 1.8391, lr_0 = 9.8497e-04
Loss = 1.4736e-02, PNorm = 34.2072, GNorm = 1.1923, lr_0 = 9.6853e-04
Loss = 1.5013e-02, PNorm = 34.2470, GNorm = 1.0729, lr_0 = 9.5236e-04
Validation rmse = 0.458836
Epoch 3
Loss = 1.4138e-02, PNorm = 34.2821, GNorm = 0.8574, lr_0 = 9.3646e-04
Loss = 1.5221e-02, PNorm = 34.3324, GNorm = 1.7869, lr_0 = 9.2083e-04
Loss = 1.4031e-02, PNorm = 34.3803, GNorm = 1.1863, lr_0 = 9.0546e-04
Loss = 1.2254e-02, PNorm = 34.4210, GNorm = 1.6519, lr_0 = 8.9035e-04
Validation rmse = 0.445275
Epoch 4
Loss = 1.4546e-02, PNorm = 34.4752, GNorm = 1.2820, lr_0 = 8.7549e-04
Loss = 1.3482e-02, PNorm = 34.5293, GNorm = 1.5462, lr_0 = 8.6088e-04
Loss = 1.2484e-02, PNorm = 34.5703, GNorm = 0.8043, lr_0 = 8.4651e-04
Loss = 1.3262e-02, PNorm = 34.6246, GNorm = 1.0194, lr_0 = 8.3238e-04
Validation rmse = 0.440852
Epoch 5
Loss = 1.2571e-02, PNorm = 34.6777, GNorm = 0.6125, lr_0 = 8.1849e-04
Loss = 1.1650e-02, PNorm = 34.7280, GNorm = 1.2643, lr_0 = 8.0483e-04
Loss = 1.3695e-02, PNorm = 34.7863, GNorm = 1.6439, lr_0 = 7.9139e-04
Validation rmse = 0.429498
Epoch 6
Loss = 1.0215e-02, PNorm = 34.8613, GNorm = 1.5806, lr_0 = 7.7818e-04
Loss = 1.3126e-02, PNorm = 34.9205, GNorm = 1.3851, lr_0 = 7.6519e-04
Loss = 1.1358e-02, PNorm = 34.9804, GNorm = 1.1842, lr_0 = 7.5242e-04
Loss = 1.1804e-02, PNorm = 35.0334, GNorm = 1.5664, lr_0 = 7.3986e-04
Validation rmse = 0.435209
Epoch 7
Loss = 9.8208e-03, PNorm = 35.0922, GNorm = 1.8566, lr_0 = 7.2752e-04
Loss = 1.0871e-02, PNorm = 35.1452, GNorm = 2.2559, lr_0 = 7.1537e-04
Loss = 1.3159e-02, PNorm = 35.2057, GNorm = 1.5884, lr_0 = 7.0343e-04
Validation rmse = 0.401226
Epoch 8
Loss = 1.1913e-02, PNorm = 35.2619, GNorm = 2.3858, lr_0 = 6.9169e-04
Loss = 1.1507e-02, PNorm = 35.3405, GNorm = 1.0640, lr_0 = 6.8015e-04
Loss = 1.1148e-02, PNorm = 35.4000, GNorm = 1.1185, lr_0 = 6.6879e-04
Loss = 9.7328e-03, PNorm = 35.4423, GNorm = 1.5440, lr_0 = 6.5763e-04
Validation rmse = 0.451448
Epoch 9
Loss = 1.1687e-02, PNorm = 35.4761, GNorm = 1.3848, lr_0 = 6.4665e-04
Loss = 1.0467e-02, PNorm = 35.5265, GNorm = 3.2591, lr_0 = 6.3586e-04
Loss = 1.1091e-02, PNorm = 35.5672, GNorm = 2.8392, lr_0 = 6.2525e-04
Loss = 1.0885e-02, PNorm = 35.6252, GNorm = 1.2529, lr_0 = 6.1481e-04
Validation rmse = 0.411383
Epoch 10
Loss = 9.8095e-03, PNorm = 35.6803, GNorm = 1.8493, lr_0 = 6.0455e-04
Loss = 1.1545e-02, PNorm = 35.7026, GNorm = 1.8706, lr_0 = 5.9446e-04
Loss = 1.0686e-02, PNorm = 35.7476, GNorm = 0.9768, lr_0 = 5.8454e-04
Validation rmse = 0.425830
Epoch 11
Loss = 1.2454e-02, PNorm = 35.7986, GNorm = 2.0262, lr_0 = 5.7478e-04
Loss = 9.8199e-03, PNorm = 35.8338, GNorm = 1.0130, lr_0 = 5.6519e-04
Loss = 1.0785e-02, PNorm = 35.8659, GNorm = 2.8476, lr_0 = 5.5575e-04
Loss = 8.3999e-03, PNorm = 35.9110, GNorm = 1.0878, lr_0 = 5.4648e-04
Validation rmse = 0.399620
Epoch 12
Loss = 1.0372e-02, PNorm = 35.9494, GNorm = 0.9825, lr_0 = 5.3736e-04
Loss = 9.6458e-03, PNorm = 35.9786, GNorm = 0.9920, lr_0 = 5.2839e-04
Loss = 9.5568e-03, PNorm = 36.0268, GNorm = 0.8202, lr_0 = 5.1957e-04
Validation rmse = 0.402567
Epoch 13
Loss = 8.6176e-03, PNorm = 36.0564, GNorm = 3.1220, lr_0 = 5.1090e-04
Loss = 1.1135e-02, PNorm = 36.0863, GNorm = 1.0788, lr_0 = 5.0237e-04
Loss = 8.8863e-03, PNorm = 36.1191, GNorm = 1.0229, lr_0 = 4.9398e-04
Loss = 8.8129e-03, PNorm = 36.1402, GNorm = 1.4530, lr_0 = 4.8574e-04
Validation rmse = 0.396770
Epoch 14
Loss = 8.5291e-03, PNorm = 36.1691, GNorm = 0.6206, lr_0 = 4.7763e-04
Loss = 9.8305e-03, PNorm = 36.1955, GNorm = 1.7586, lr_0 = 4.6966e-04
Loss = 7.0607e-03, PNorm = 36.2243, GNorm = 0.9851, lr_0 = 4.6182e-04
Loss = 1.1702e-02, PNorm = 36.2534, GNorm = 1.8757, lr_0 = 4.5411e-04
Validation rmse = 0.399715
Epoch 15
Loss = 1.0740e-02, PNorm = 36.2775, GNorm = 1.4559, lr_0 = 4.4653e-04
Loss = 8.2767e-03, PNorm = 36.3080, GNorm = 1.2850, lr_0 = 4.3908e-04
Loss = 1.0674e-02, PNorm = 36.3418, GNorm = 2.1051, lr_0 = 4.3175e-04
Validation rmse = 0.397422
Epoch 16
Loss = 8.0373e-03, PNorm = 36.3733, GNorm = 0.7243, lr_0 = 4.2455e-04
Loss = 8.3361e-03, PNorm = 36.3915, GNorm = 1.5262, lr_0 = 4.1746e-04
Loss = 1.0537e-02, PNorm = 36.4186, GNorm = 1.4084, lr_0 = 4.1049e-04
Loss = 8.2935e-03, PNorm = 36.4516, GNorm = 1.1867, lr_0 = 4.0364e-04
Validation rmse = 0.390099
Epoch 17
Loss = 8.3873e-03, PNorm = 36.4892, GNorm = 1.2381, lr_0 = 3.9690e-04
Loss = 1.0032e-02, PNorm = 36.5174, GNorm = 2.5868, lr_0 = 3.9028e-04
Loss = 7.9308e-03, PNorm = 36.5371, GNorm = 2.3707, lr_0 = 3.8376e-04
Validation rmse = 0.387876
Epoch 18
Loss = 9.7070e-03, PNorm = 36.5549, GNorm = 1.1045, lr_0 = 3.7736e-04
Loss = 8.3016e-03, PNorm = 36.5810, GNorm = 1.1104, lr_0 = 3.7106e-04
Loss = 8.9485e-03, PNorm = 36.5999, GNorm = 0.9149, lr_0 = 3.6487e-04
Loss = 9.6978e-03, PNorm = 36.6224, GNorm = 2.0912, lr_0 = 3.5878e-04
Validation rmse = 0.381824
Epoch 19
Loss = 9.3981e-03, PNorm = 36.6478, GNorm = 4.4326, lr_0 = 3.5279e-04
Loss = 7.3997e-03, PNorm = 36.6689, GNorm = 1.6166, lr_0 = 3.4690e-04
Loss = 9.8278e-03, PNorm = 36.6898, GNorm = 1.6984, lr_0 = 3.4111e-04
Loss = 8.9725e-03, PNorm = 36.7173, GNorm = 1.3977, lr_0 = 3.3542e-04
Validation rmse = 0.380964
Epoch 20
Loss = 8.6399e-03, PNorm = 36.7409, GNorm = 0.9916, lr_0 = 3.2982e-04
Loss = 7.6894e-03, PNorm = 36.7602, GNorm = 0.9219, lr_0 = 3.2431e-04
Loss = 9.0388e-03, PNorm = 36.7777, GNorm = 1.1253, lr_0 = 3.1890e-04
Validation rmse = 0.376892
Epoch 21
Loss = 9.6835e-03, PNorm = 36.8020, GNorm = 1.2097, lr_0 = 3.1358e-04
Loss = 7.7600e-03, PNorm = 36.8235, GNorm = 1.1001, lr_0 = 3.0834e-04
Loss = 8.6749e-03, PNorm = 36.8436, GNorm = 0.8907, lr_0 = 3.0320e-04
Loss = 8.4152e-03, PNorm = 36.8646, GNorm = 1.3685, lr_0 = 2.9814e-04
Validation rmse = 0.379717
Epoch 22
Loss = 8.9518e-03, PNorm = 36.8832, GNorm = 1.7914, lr_0 = 2.9316e-04
Loss = 8.2690e-03, PNorm = 36.9068, GNorm = 0.8708, lr_0 = 2.8827e-04
Loss = 8.6268e-03, PNorm = 36.9215, GNorm = 1.2178, lr_0 = 2.8346e-04
Validation rmse = 0.379298
Epoch 23
Loss = 6.8460e-03, PNorm = 36.9357, GNorm = 1.6493, lr_0 = 2.7872e-04
Loss = 8.2268e-03, PNorm = 36.9573, GNorm = 1.7326, lr_0 = 2.7407e-04
Loss = 8.8849e-03, PNorm = 36.9771, GNorm = 0.9262, lr_0 = 2.6950e-04
Loss = 7.9397e-03, PNorm = 36.9967, GNorm = 1.0223, lr_0 = 2.6500e-04
Validation rmse = 0.385391
Epoch 24
Loss = 9.8120e-03, PNorm = 37.0157, GNorm = 2.1080, lr_0 = 2.6058e-04
Loss = 8.9325e-03, PNorm = 37.0291, GNorm = 1.9302, lr_0 = 2.5623e-04
Loss = 7.5829e-03, PNorm = 37.0451, GNorm = 1.8177, lr_0 = 2.5195e-04
Loss = 7.5064e-03, PNorm = 37.0643, GNorm = 1.5731, lr_0 = 2.4775e-04
Validation rmse = 0.382480
Epoch 25
Loss = 7.1167e-03, PNorm = 37.0846, GNorm = 1.3498, lr_0 = 2.4361e-04
Loss = 8.8032e-03, PNorm = 37.1003, GNorm = 0.8533, lr_0 = 2.3954e-04
Loss = 8.2171e-03, PNorm = 37.1163, GNorm = 3.0016, lr_0 = 2.3555e-04
Validation rmse = 0.378375
Epoch 26
Loss = 6.6872e-03, PNorm = 37.1339, GNorm = 1.1447, lr_0 = 2.3161e-04
Loss = 9.0314e-03, PNorm = 37.1449, GNorm = 1.3825, lr_0 = 2.2775e-04
Loss = 6.8645e-03, PNorm = 37.1640, GNorm = 2.2265, lr_0 = 2.2395e-04
Loss = 9.3945e-03, PNorm = 37.1760, GNorm = 2.1851, lr_0 = 2.2021e-04
Validation rmse = 0.369865
Epoch 27
Loss = 8.1400e-03, PNorm = 37.1934, GNorm = 0.9530, lr_0 = 2.1653e-04
Loss = 8.6153e-03, PNorm = 37.2083, GNorm = 0.7964, lr_0 = 2.1292e-04
Loss = 7.8627e-03, PNorm = 37.2246, GNorm = 1.6907, lr_0 = 2.0937e-04
Validation rmse = 0.378822
Epoch 28
Loss = 6.0934e-03, PNorm = 37.2443, GNorm = 0.9611, lr_0 = 2.0587e-04
Loss = 7.5123e-03, PNorm = 37.2540, GNorm = 1.0662, lr_0 = 2.0244e-04
Loss = 8.9615e-03, PNorm = 37.2651, GNorm = 0.8937, lr_0 = 1.9906e-04
Loss = 8.0150e-03, PNorm = 37.2784, GNorm = 1.3152, lr_0 = 1.9573e-04
Validation rmse = 0.366529
Epoch 29
Loss = 7.9375e-03, PNorm = 37.2941, GNorm = 1.6767, lr_0 = 1.9247e-04
Loss = 7.4931e-03, PNorm = 37.3072, GNorm = 1.2238, lr_0 = 1.8925e-04
Loss = 7.5434e-03, PNorm = 37.3200, GNorm = 1.6033, lr_0 = 1.8610e-04
Loss = 8.4807e-03, PNorm = 37.3321, GNorm = 1.8557, lr_0 = 1.8299e-04
Validation rmse = 0.374018
Epoch 30
Loss = 9.5928e-03, PNorm = 37.3436, GNorm = 1.4352, lr_0 = 1.7994e-04
Loss = 6.8392e-03, PNorm = 37.3541, GNorm = 1.7084, lr_0 = 1.7693e-04
Loss = 7.8522e-03, PNorm = 37.3639, GNorm = 0.8489, lr_0 = 1.7398e-04
Validation rmse = 0.371328
Epoch 31
Loss = 6.5281e-03, PNorm = 37.3762, GNorm = 1.0638, lr_0 = 1.7108e-04
Loss = 7.3617e-03, PNorm = 37.3898, GNorm = 2.3048, lr_0 = 1.6822e-04
Loss = 8.6203e-03, PNorm = 37.4012, GNorm = 3.0226, lr_0 = 1.6541e-04
Loss = 8.3485e-03, PNorm = 37.4162, GNorm = 0.8790, lr_0 = 1.6265e-04
Validation rmse = 0.366889
Epoch 32
Loss = 5.1921e-03, PNorm = 37.4258, GNorm = 1.3056, lr_0 = 1.5994e-04
Loss = 8.2051e-03, PNorm = 37.4367, GNorm = 1.4831, lr_0 = 1.5727e-04
Loss = 7.8853e-03, PNorm = 37.4475, GNorm = 1.1272, lr_0 = 1.5464e-04
Validation rmse = 0.374197
Epoch 33
Loss = 5.9075e-03, PNorm = 37.4558, GNorm = 0.5929, lr_0 = 1.5206e-04
Loss = 8.0432e-03, PNorm = 37.4674, GNorm = 1.9601, lr_0 = 1.4952e-04
Loss = 7.4953e-03, PNorm = 37.4795, GNorm = 1.2941, lr_0 = 1.4703e-04
Loss = 8.1206e-03, PNorm = 37.4877, GNorm = 0.9023, lr_0 = 1.4457e-04
Validation rmse = 0.373839
Epoch 34
Loss = 8.3041e-03, PNorm = 37.4985, GNorm = 1.9113, lr_0 = 1.4216e-04
Loss = 5.8440e-03, PNorm = 37.5102, GNorm = 1.9673, lr_0 = 1.3979e-04
Loss = 7.8856e-03, PNorm = 37.5178, GNorm = 1.7692, lr_0 = 1.3745e-04
Loss = 8.5539e-03, PNorm = 37.5257, GNorm = 2.7577, lr_0 = 1.3516e-04
Validation rmse = 0.362490
Epoch 35
Loss = 8.0192e-03, PNorm = 37.5370, GNorm = 1.3232, lr_0 = 1.3290e-04
Loss = 7.3019e-03, PNorm = 37.5495, GNorm = 1.4557, lr_0 = 1.3069e-04
Loss = 7.4922e-03, PNorm = 37.5542, GNorm = 2.4054, lr_0 = 1.2850e-04
Validation rmse = 0.361034
Epoch 36
Loss = 5.9450e-03, PNorm = 37.5610, GNorm = 1.0257, lr_0 = 1.2636e-04
Loss = 7.2249e-03, PNorm = 37.5715, GNorm = 1.3436, lr_0 = 1.2425e-04
Loss = 8.0689e-03, PNorm = 37.5793, GNorm = 1.1452, lr_0 = 1.2218e-04
Loss = 7.4502e-03, PNorm = 37.5885, GNorm = 1.0448, lr_0 = 1.2014e-04
Validation rmse = 0.366890
Epoch 37
Loss = 6.8506e-03, PNorm = 37.5952, GNorm = 1.5742, lr_0 = 1.1813e-04
Loss = 8.1868e-03, PNorm = 37.6013, GNorm = 0.9113, lr_0 = 1.1616e-04
Loss = 7.2181e-03, PNorm = 37.6077, GNorm = 1.1147, lr_0 = 1.1422e-04
Validation rmse = 0.362434
Epoch 38
Loss = 5.7982e-03, PNorm = 37.6200, GNorm = 0.6993, lr_0 = 1.1232e-04
Loss = 6.8086e-03, PNorm = 37.6276, GNorm = 1.0259, lr_0 = 1.1044e-04
Loss = 7.3555e-03, PNorm = 37.6349, GNorm = 1.2646, lr_0 = 1.0860e-04
Loss = 8.2460e-03, PNorm = 37.6450, GNorm = 1.8496, lr_0 = 1.0678e-04
Validation rmse = 0.374665
Epoch 39
Loss = 7.4390e-03, PNorm = 37.6515, GNorm = 1.2295, lr_0 = 1.0500e-04
Loss = 7.3706e-03, PNorm = 37.6575, GNorm = 1.2309, lr_0 = 1.0325e-04
Loss = 7.6058e-03, PNorm = 37.6654, GNorm = 1.1476, lr_0 = 1.0153e-04
Loss = 7.2378e-03, PNorm = 37.6728, GNorm = 1.7036, lr_0 = 1.0000e-04
Validation rmse = 0.363131
Model 0 best validation rmse = 0.361034 on epoch 35
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.369391
Ensemble test rmse = 0.369391
1-fold cross validation
Seed 5 ==> test rmse = 0.369391
Overall test rmse = 0.369391 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/Fully_random_splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 40,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/Fully_random_splits/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/Fully_random_splits/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/Fully_random_splits/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/Fully_random_splits/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/Fully_random_splits/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/Fully_random_splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 3
Splitting data with seed 5
Total size = 1,804 | train size = 1,804 | val size = 602 | test size = 602
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=310, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 358,503
Epoch 0
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/Fully_random_splits/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 40,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/Fully_random_splits/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/Fully_random_splits/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/Fully_random_splits/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/Fully_random_splits/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/Fully_random_splits/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/Fully_random_splits/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 3
Splitting data with seed 5
Total size = 1,804 | train size = 1,804 | val size = 602 | test size = 602
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=310, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 358,503
Epoch 0
