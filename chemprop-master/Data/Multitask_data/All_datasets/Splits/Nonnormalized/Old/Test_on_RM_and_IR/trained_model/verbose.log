Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 40,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 2
Splitting data with seed 5
Total size = 1,018 | train size = 1,018 | val size = 255 | test size = 1,735
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=310, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 448,502
Epoch 0
Loss = 2.0090e-02, PNorm = 38.1979, GNorm = 2.7511, lr_0 = 3.4750e-04
Loss = 1.8363e-02, PNorm = 38.2106, GNorm = 1.2446, lr_0 = 5.7250e-04
Validation rmse = 0.265820
Epoch 1
Loss = 1.6917e-02, PNorm = 38.2275, GNorm = 0.9487, lr_0 = 7.9750e-04
Loss = 2.0019e-02, PNorm = 38.2472, GNorm = 4.6835, lr_0 = 9.9697e-04
Validation rmse = 0.266046
Epoch 2
Loss = 2.1054e-02, PNorm = 38.2836, GNorm = 1.4547, lr_0 = 9.6722e-04
Loss = 1.6814e-02, PNorm = 38.3230, GNorm = 0.6263, lr_0 = 9.3836e-04
Validation rmse = 0.272069
Epoch 3
Loss = 1.5394e-02, PNorm = 38.3663, GNorm = 1.0292, lr_0 = 9.1035e-04
Loss = 2.0129e-02, PNorm = 38.4102, GNorm = 1.4435, lr_0 = 8.8319e-04
Validation rmse = 0.266780
Epoch 4
Loss = 1.7679e-02, PNorm = 38.4575, GNorm = 1.1930, lr_0 = 8.5683e-04
Loss = 1.5722e-02, PNorm = 38.5057, GNorm = 1.2342, lr_0 = 8.3126e-04
Validation rmse = 0.265420
Epoch 5
Loss = 1.5024e-02, PNorm = 38.5523, GNorm = 3.1077, lr_0 = 8.0645e-04
Loss = 1.7405e-02, PNorm = 38.6037, GNorm = 1.5794, lr_0 = 7.8239e-04
Validation rmse = 0.256471
Epoch 6
Loss = 1.7511e-02, PNorm = 38.6439, GNorm = 1.3581, lr_0 = 7.5904e-04
Loss = 1.5085e-02, PNorm = 38.7050, GNorm = 0.9705, lr_0 = 7.3639e-04
Validation rmse = 0.253031
Epoch 7
Loss = 1.9698e-02, PNorm = 38.7493, GNorm = 3.1604, lr_0 = 7.1441e-04
Loss = 1.2138e-02, PNorm = 38.7951, GNorm = 0.8412, lr_0 = 6.9309e-04
Validation rmse = 0.251543
Epoch 8
Loss = 1.4249e-02, PNorm = 38.8326, GNorm = 1.1114, lr_0 = 6.7241e-04
Loss = 1.5431e-02, PNorm = 38.8884, GNorm = 0.8042, lr_0 = 6.5234e-04
Validation rmse = 0.245065
Epoch 9
Loss = 1.3440e-02, PNorm = 38.9153, GNorm = 0.3759, lr_0 = 6.3287e-04
Loss = 1.4303e-02, PNorm = 38.9633, GNorm = 2.0303, lr_0 = 6.1399e-04
Validation rmse = 0.238621
Epoch 10
Loss = 1.3414e-02, PNorm = 39.0042, GNorm = 1.4269, lr_0 = 5.9566e-04
Loss = 1.3650e-02, PNorm = 39.0374, GNorm = 2.9790, lr_0 = 5.7789e-04
Validation rmse = 0.243469
Epoch 11
Loss = 1.1580e-02, PNorm = 39.0666, GNorm = 1.2594, lr_0 = 5.6064e-04
Loss = 1.4930e-02, PNorm = 39.1010, GNorm = 2.9202, lr_0 = 5.4391e-04
Validation rmse = 0.231098
Epoch 12
Loss = 1.2480e-02, PNorm = 39.1382, GNorm = 4.6488, lr_0 = 5.2768e-04
Loss = 1.2228e-02, PNorm = 39.1654, GNorm = 2.5391, lr_0 = 5.1193e-04
Validation rmse = 0.231881
Epoch 13
Loss = 1.1986e-02, PNorm = 39.1851, GNorm = 3.2451, lr_0 = 4.9665e-04
Loss = 1.3423e-02, PNorm = 39.2156, GNorm = 4.1723, lr_0 = 4.8183e-04
Validation rmse = 0.261371
Epoch 14
Loss = 1.7483e-02, PNorm = 39.2340, GNorm = 1.2367, lr_0 = 4.6745e-04
Loss = 1.1936e-02, PNorm = 39.2584, GNorm = 2.1144, lr_0 = 4.5350e-04
Validation rmse = 0.240852
Epoch 15
Loss = 1.3779e-02, PNorm = 39.2858, GNorm = 3.2033, lr_0 = 4.3997e-04
Loss = 1.1601e-02, PNorm = 39.3108, GNorm = 1.5224, lr_0 = 4.2684e-04
Validation rmse = 0.234268
Epoch 16
Loss = 1.1622e-02, PNorm = 39.3327, GNorm = 1.1225, lr_0 = 4.1410e-04
Loss = 1.1961e-02, PNorm = 39.3532, GNorm = 1.0867, lr_0 = 4.0174e-04
Validation rmse = 0.234924
Epoch 17
Loss = 1.0454e-02, PNorm = 39.3735, GNorm = 0.7426, lr_0 = 3.8975e-04
Loss = 1.3062e-02, PNorm = 39.3955, GNorm = 2.5230, lr_0 = 3.7812e-04
Validation rmse = 0.237084
Epoch 18
Loss = 1.1757e-02, PNorm = 39.4205, GNorm = 5.5213, lr_0 = 3.6684e-04
Loss = 1.2397e-02, PNorm = 39.4421, GNorm = 4.7755, lr_0 = 3.5589e-04
Validation rmse = 0.233526
Epoch 19
Loss = 1.2569e-02, PNorm = 39.4576, GNorm = 3.6444, lr_0 = 3.4527e-04
Loss = 1.4487e-02, PNorm = 39.4804, GNorm = 6.3731, lr_0 = 3.3497e-04
Validation rmse = 0.236979
Epoch 20
Loss = 1.3760e-02, PNorm = 39.4953, GNorm = 2.7493, lr_0 = 3.2497e-04
Loss = 1.1172e-02, PNorm = 39.5100, GNorm = 0.8848, lr_0 = 3.1527e-04
Validation rmse = 0.236979
Epoch 21
Loss = 1.0411e-02, PNorm = 39.5255, GNorm = 0.6475, lr_0 = 3.0586e-04
Loss = 1.2644e-02, PNorm = 39.5434, GNorm = 1.9986, lr_0 = 2.9673e-04
Validation rmse = 0.233888
Epoch 22
Loss = 1.0477e-02, PNorm = 39.5623, GNorm = 4.6577, lr_0 = 2.8788e-04
Loss = 1.1958e-02, PNorm = 39.5810, GNorm = 1.3914, lr_0 = 2.7929e-04
Validation rmse = 0.234623
Epoch 23
Loss = 1.2347e-02, PNorm = 39.5945, GNorm = 2.6128, lr_0 = 2.7095e-04
Loss = 9.2362e-03, PNorm = 39.6112, GNorm = 1.0776, lr_0 = 2.6287e-04
Validation rmse = 0.237365
Epoch 24
Loss = 1.0178e-02, PNorm = 39.6239, GNorm = 1.3919, lr_0 = 2.5502e-04
Loss = 1.1617e-02, PNorm = 39.6438, GNorm = 0.7107, lr_0 = 2.4741e-04
Validation rmse = 0.235136
Epoch 25
Loss = 1.1569e-02, PNorm = 39.6611, GNorm = 2.4008, lr_0 = 2.4003e-04
Loss = 1.0016e-02, PNorm = 39.6811, GNorm = 2.7417, lr_0 = 2.3287e-04
Validation rmse = 0.237959
Epoch 26
Loss = 1.1053e-02, PNorm = 39.6937, GNorm = 2.3658, lr_0 = 2.2592e-04
Loss = 1.0535e-02, PNorm = 39.7114, GNorm = 2.3028, lr_0 = 2.1917e-04
Validation rmse = 0.235968
Epoch 27
Loss = 9.8324e-03, PNorm = 39.7246, GNorm = 5.0930, lr_0 = 2.1263e-04
Loss = 1.1689e-02, PNorm = 39.7424, GNorm = 3.0068, lr_0 = 2.0629e-04
Validation rmse = 0.236226
Epoch 28
Loss = 9.2604e-03, PNorm = 39.7536, GNorm = 1.6476, lr_0 = 2.0013e-04
Loss = 1.1248e-02, PNorm = 39.7667, GNorm = 1.4330, lr_0 = 1.9416e-04
Validation rmse = 0.239302
Epoch 29
Loss = 9.3745e-03, PNorm = 39.7826, GNorm = 1.5742, lr_0 = 1.8836e-04
Loss = 1.1101e-02, PNorm = 39.7969, GNorm = 3.7027, lr_0 = 1.8274e-04
Validation rmse = 0.237885
Epoch 30
Loss = 1.1041e-02, PNorm = 39.8110, GNorm = 0.7727, lr_0 = 1.7729e-04
Loss = 9.0809e-03, PNorm = 39.8254, GNorm = 3.9676, lr_0 = 1.7200e-04
Validation rmse = 0.238039
Epoch 31
Loss = 1.0694e-02, PNorm = 39.8359, GNorm = 3.9740, lr_0 = 1.6687e-04
Loss = 9.3723e-03, PNorm = 39.8476, GNorm = 1.9698, lr_0 = 1.6189e-04
Validation rmse = 0.236921
Epoch 32
Loss = 1.0118e-02, PNorm = 39.8615, GNorm = 3.5937, lr_0 = 1.5706e-04
Loss = 8.9137e-03, PNorm = 39.8725, GNorm = 0.7676, lr_0 = 1.5237e-04
Validation rmse = 0.239417
Epoch 33
Loss = 9.1499e-03, PNorm = 39.8829, GNorm = 1.0772, lr_0 = 1.4782e-04
Loss = 1.0254e-02, PNorm = 39.8947, GNorm = 1.0962, lr_0 = 1.4341e-04
Validation rmse = 0.240639
Epoch 34
Loss = 1.0326e-02, PNorm = 39.9059, GNorm = 1.1033, lr_0 = 1.3913e-04
Loss = 8.8002e-03, PNorm = 39.9157, GNorm = 1.6357, lr_0 = 1.3498e-04
Validation rmse = 0.238319
Epoch 35
Loss = 9.8054e-03, PNorm = 39.9293, GNorm = 5.1068, lr_0 = 1.3095e-04
Loss = 9.0043e-03, PNorm = 39.9403, GNorm = 2.2339, lr_0 = 1.2704e-04
Validation rmse = 0.239520
Epoch 36
Loss = 8.7737e-03, PNorm = 39.9472, GNorm = 3.9263, lr_0 = 1.2325e-04
Loss = 1.0105e-02, PNorm = 39.9577, GNorm = 1.4347, lr_0 = 1.1957e-04
Validation rmse = 0.237255
Epoch 37
Loss = 1.0482e-02, PNorm = 39.9669, GNorm = 1.6023, lr_0 = 1.1600e-04
Loss = 8.4442e-03, PNorm = 39.9767, GNorm = 0.6915, lr_0 = 1.1254e-04
Validation rmse = 0.241940
Epoch 38
Loss = 1.0060e-02, PNorm = 39.9872, GNorm = 1.4007, lr_0 = 1.0918e-04
Loss = 9.0810e-03, PNorm = 39.9954, GNorm = 2.6316, lr_0 = 1.0593e-04
Validation rmse = 0.239611
Epoch 39
Loss = 9.6105e-03, PNorm = 40.0039, GNorm = 3.2630, lr_0 = 1.0276e-04
Loss = 8.8496e-03, PNorm = 40.0103, GNorm = 8.8704, lr_0 = 1.0000e-04
Validation rmse = 0.243323
Model 0 best validation rmse = 0.231098 on epoch 11
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 1064105225444.847412
Ensemble test rmse = 1064105225444.847412
1-fold cross validation
Seed 5 ==> test rmse = 1064105225444.847412
Overall test rmse = 1064105225444.847412 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 40,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/Test_on_RM_and_IR/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 2
Splitting data with seed 5
Total size = 1,018 | train size = 1,018 | val size = 255 | test size = 1,735
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=310, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 448,502
Epoch 0
