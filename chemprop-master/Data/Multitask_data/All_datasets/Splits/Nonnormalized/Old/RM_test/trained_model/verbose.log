Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/RM_test/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/RM_test/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/RM_test/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/RM_test/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/RM_test/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/RM_test/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/RM_test/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 3
Splitting data with seed 5
Total size = 1,469 | train size = 1,469 | val size = 368 | test size = 1,171
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=310, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=300, out_features=3, bias=True)
  )
)
Number of parameters = 448,803
Epoch 0
Loss = 1.9750e-02, PNorm = 38.3287, GNorm = 4.1072, lr_0 = 2.7069e-04
Loss = 1.9893e-02, PNorm = 38.3373, GNorm = 0.9070, lr_0 = 4.2586e-04
Validation rmse = 0.535101
Epoch 1
Loss = 1.2553e-02, PNorm = 38.3547, GNorm = 2.9201, lr_0 = 5.8103e-04
Loss = 1.5866e-02, PNorm = 38.3788, GNorm = 0.8783, lr_0 = 7.3621e-04
Loss = 2.0966e-02, PNorm = 38.4083, GNorm = 1.6088, lr_0 = 8.9138e-04
Validation rmse = 0.521253
Epoch 2
Loss = 1.1633e-02, PNorm = 38.4503, GNorm = 0.8028, lr_0 = 9.9505e-04
Loss = 1.4701e-02, PNorm = 38.4977, GNorm = 0.9177, lr_0 = 9.7873e-04
Loss = 1.6929e-02, PNorm = 38.5420, GNorm = 1.2104, lr_0 = 9.6267e-04
Validation rmse = 0.486311
Epoch 3
Loss = 1.7520e-02, PNorm = 38.5988, GNorm = 2.5224, lr_0 = 9.4688e-04
Loss = 1.4752e-02, PNorm = 38.6592, GNorm = 3.3822, lr_0 = 9.3134e-04
Loss = 1.5034e-02, PNorm = 38.7095, GNorm = 1.2295, lr_0 = 9.1606e-04
Validation rmse = 0.504169
Epoch 4
Loss = 1.9698e-02, PNorm = 38.7534, GNorm = 0.9990, lr_0 = 9.0103e-04
Loss = 1.5866e-02, PNorm = 38.8153, GNorm = 3.5801, lr_0 = 8.8625e-04
Loss = 1.3715e-02, PNorm = 38.8613, GNorm = 1.1048, lr_0 = 8.7171e-04
Validation rmse = 0.536042
Epoch 5
Loss = 1.4974e-02, PNorm = 38.9189, GNorm = 1.1788, lr_0 = 8.5741e-04
Loss = 1.4776e-02, PNorm = 38.9807, GNorm = 1.9650, lr_0 = 8.4335e-04
Loss = 1.2610e-02, PNorm = 39.0582, GNorm = 3.4866, lr_0 = 8.2951e-04
Validation rmse = 0.467009
Epoch 6
Loss = 1.1812e-02, PNorm = 39.1295, GNorm = 4.9335, lr_0 = 8.1590e-04
Loss = 1.3075e-02, PNorm = 39.1883, GNorm = 1.7437, lr_0 = 8.0252e-04
Loss = 1.2391e-02, PNorm = 39.2633, GNorm = 1.7152, lr_0 = 7.8935e-04
Validation rmse = 0.535020
Epoch 7
Loss = 1.9039e-02, PNorm = 39.3056, GNorm = 4.0718, lr_0 = 7.7640e-04
Loss = 1.3421e-02, PNorm = 39.3619, GNorm = 1.1025, lr_0 = 7.6366e-04
Loss = 1.3348e-02, PNorm = 39.4313, GNorm = 1.4155, lr_0 = 7.5114e-04
Validation rmse = 0.456495
Epoch 8
Loss = 1.3292e-02, PNorm = 39.4830, GNorm = 1.9861, lr_0 = 7.3881e-04
Loss = 1.2183e-02, PNorm = 39.5446, GNorm = 1.1023, lr_0 = 7.2669e-04
Loss = 1.1635e-02, PNorm = 39.6081, GNorm = 1.1899, lr_0 = 7.1477e-04
Validation rmse = 0.445544
Epoch 9
Loss = 1.0646e-02, PNorm = 39.6759, GNorm = 2.8627, lr_0 = 7.0304e-04
Loss = 1.1422e-02, PNorm = 39.7227, GNorm = 1.4932, lr_0 = 6.9151e-04
Loss = 1.2020e-02, PNorm = 39.7799, GNorm = 2.2701, lr_0 = 6.8017e-04
Validation rmse = 0.428264
Epoch 10
Loss = 1.1675e-02, PNorm = 39.8150, GNorm = 2.9953, lr_0 = 6.6901e-04
Loss = 1.2610e-02, PNorm = 39.8456, GNorm = 1.6682, lr_0 = 6.5803e-04
Validation rmse = 0.454287
Epoch 11
Loss = 1.1827e-02, PNorm = 39.9018, GNorm = 2.1381, lr_0 = 6.4724e-04
Loss = 1.1285e-02, PNorm = 39.9553, GNorm = 0.8184, lr_0 = 6.3662e-04
Loss = 1.0032e-02, PNorm = 40.0042, GNorm = 1.6133, lr_0 = 6.2617e-04
Validation rmse = 0.419924
Epoch 12
Loss = 1.1171e-02, PNorm = 40.0317, GNorm = 4.2758, lr_0 = 6.1590e-04
Loss = 1.0432e-02, PNorm = 40.0564, GNorm = 1.8307, lr_0 = 6.0580e-04
Loss = 1.1381e-02, PNorm = 40.0709, GNorm = 1.4031, lr_0 = 5.9586e-04
Validation rmse = 0.431911
Epoch 13
Loss = 1.4445e-02, PNorm = 40.1060, GNorm = 2.9600, lr_0 = 5.8608e-04
Loss = 9.6844e-03, PNorm = 40.1360, GNorm = 2.7214, lr_0 = 5.7647e-04
Loss = 1.1511e-02, PNorm = 40.1788, GNorm = 1.4706, lr_0 = 5.6701e-04
Validation rmse = 0.416151
Epoch 14
Loss = 9.4278e-03, PNorm = 40.2031, GNorm = 2.0255, lr_0 = 5.5771e-04
Loss = 1.0472e-02, PNorm = 40.2348, GNorm = 1.6081, lr_0 = 5.4856e-04
Loss = 1.0029e-02, PNorm = 40.2720, GNorm = 1.5754, lr_0 = 5.3956e-04
Validation rmse = 0.424835
Epoch 15
Loss = 1.1216e-02, PNorm = 40.3021, GNorm = 0.8168, lr_0 = 5.3071e-04
Loss = 1.0720e-02, PNorm = 40.3321, GNorm = 1.3367, lr_0 = 5.2200e-04
Loss = 8.9907e-03, PNorm = 40.3632, GNorm = 0.7916, lr_0 = 5.1344e-04
Validation rmse = 0.435091
Epoch 16
Loss = 8.3132e-03, PNorm = 40.3879, GNorm = 1.0541, lr_0 = 5.0502e-04
Loss = 9.3285e-03, PNorm = 40.4113, GNorm = 0.9406, lr_0 = 4.9673e-04
Loss = 9.6778e-03, PNorm = 40.4502, GNorm = 0.8045, lr_0 = 4.8858e-04
Validation rmse = 0.409377
Epoch 17
Loss = 9.7645e-03, PNorm = 40.4834, GNorm = 1.7590, lr_0 = 4.8057e-04
Loss = 9.4652e-03, PNorm = 40.5058, GNorm = 1.9212, lr_0 = 4.7268e-04
Loss = 9.7295e-03, PNorm = 40.5431, GNorm = 1.7804, lr_0 = 4.6493e-04
Validation rmse = 0.420607
Epoch 18
Loss = 1.0700e-02, PNorm = 40.5660, GNorm = 3.2610, lr_0 = 4.5730e-04
Loss = 9.4200e-03, PNorm = 40.5946, GNorm = 2.1054, lr_0 = 4.4980e-04
Loss = 9.3775e-03, PNorm = 40.6221, GNorm = 0.9937, lr_0 = 4.4242e-04
Validation rmse = 0.411984
Epoch 19
Loss = 9.3852e-03, PNorm = 40.6552, GNorm = 3.6724, lr_0 = 4.3516e-04
Loss = 1.1371e-02, PNorm = 40.6808, GNorm = 1.1464, lr_0 = 4.2802e-04
Loss = 7.9967e-03, PNorm = 40.7063, GNorm = 1.7105, lr_0 = 4.2100e-04
Validation rmse = 0.421481
Epoch 20
Loss = 7.3297e-03, PNorm = 40.7293, GNorm = 2.0197, lr_0 = 4.1409e-04
Loss = 1.1154e-02, PNorm = 40.7560, GNorm = 2.0104, lr_0 = 4.0730e-04
Validation rmse = 0.420237
Epoch 21
Loss = 1.4985e-02, PNorm = 40.7827, GNorm = 2.6601, lr_0 = 4.0062e-04
Loss = 6.8207e-03, PNorm = 40.8092, GNorm = 0.6835, lr_0 = 3.9405e-04
Loss = 7.6582e-03, PNorm = 40.8283, GNorm = 1.0891, lr_0 = 3.8758e-04
Validation rmse = 0.418867
Epoch 22
Loss = 1.0559e-02, PNorm = 40.8475, GNorm = 1.1612, lr_0 = 3.8122e-04
Loss = 7.3614e-03, PNorm = 40.8758, GNorm = 1.8696, lr_0 = 3.7497e-04
Loss = 1.0531e-02, PNorm = 40.8991, GNorm = 1.8866, lr_0 = 3.6882e-04
Validation rmse = 0.412271
Epoch 23
Loss = 1.1313e-02, PNorm = 40.9315, GNorm = 0.9789, lr_0 = 3.6277e-04
Loss = 7.8206e-03, PNorm = 40.9615, GNorm = 1.4150, lr_0 = 3.5681e-04
Loss = 7.8075e-03, PNorm = 40.9926, GNorm = 1.1820, lr_0 = 3.5096e-04
Validation rmse = 0.409509
Epoch 24
Loss = 9.4370e-03, PNorm = 41.0074, GNorm = 3.1047, lr_0 = 3.4520e-04
Loss = 9.1735e-03, PNorm = 41.0349, GNorm = 1.2423, lr_0 = 3.3954e-04
Loss = 6.8750e-03, PNorm = 41.0566, GNorm = 2.4349, lr_0 = 3.3397e-04
Validation rmse = 0.411593
Epoch 25
Loss = 8.3754e-03, PNorm = 41.0821, GNorm = 1.8786, lr_0 = 3.2849e-04
Loss = 8.2567e-03, PNorm = 41.1110, GNorm = 0.6903, lr_0 = 3.2310e-04
Loss = 8.4969e-03, PNorm = 41.1315, GNorm = 3.8624, lr_0 = 3.1780e-04
Validation rmse = 0.414425
Epoch 26
Loss = 8.6522e-03, PNorm = 41.1523, GNorm = 2.1403, lr_0 = 3.1259e-04
Loss = 7.7685e-03, PNorm = 41.1788, GNorm = 3.6718, lr_0 = 3.0746e-04
Loss = 8.2608e-03, PNorm = 41.1981, GNorm = 1.4136, lr_0 = 3.0242e-04
Validation rmse = 0.418679
Epoch 27
Loss = 7.0457e-03, PNorm = 41.2165, GNorm = 2.2178, lr_0 = 2.9745e-04
Loss = 7.0961e-03, PNorm = 41.2371, GNorm = 1.1820, lr_0 = 2.9257e-04
Loss = 9.1756e-03, PNorm = 41.2572, GNorm = 0.9427, lr_0 = 2.8777e-04
Validation rmse = 0.410715
Epoch 28
Loss = 8.1120e-03, PNorm = 41.2765, GNorm = 1.3537, lr_0 = 2.8305e-04
Loss = 8.9493e-03, PNorm = 41.2943, GNorm = 1.0643, lr_0 = 2.7841e-04
Loss = 8.3044e-03, PNorm = 41.3189, GNorm = 0.6555, lr_0 = 2.7384e-04
Validation rmse = 0.413301
Epoch 29
Loss = 9.3721e-03, PNorm = 41.3341, GNorm = 1.6209, lr_0 = 2.6935e-04
Loss = 8.2149e-03, PNorm = 41.3529, GNorm = 1.0223, lr_0 = 2.6493e-04
Loss = 8.4319e-03, PNorm = 41.3688, GNorm = 1.2831, lr_0 = 2.6058e-04
Validation rmse = 0.407353
Epoch 30
Loss = 8.0505e-03, PNorm = 41.3888, GNorm = 2.1683, lr_0 = 2.5631e-04
Loss = 6.9833e-03, PNorm = 41.4045, GNorm = 1.9693, lr_0 = 2.5210e-04
Validation rmse = 0.413557
Epoch 31
Loss = 1.1995e-02, PNorm = 41.4187, GNorm = 1.3532, lr_0 = 2.4797e-04
Loss = 7.6996e-03, PNorm = 41.4356, GNorm = 1.6326, lr_0 = 2.4390e-04
Loss = 6.9561e-03, PNorm = 41.4543, GNorm = 2.0503, lr_0 = 2.3990e-04
Validation rmse = 0.403369
Epoch 32
Loss = 1.1388e-02, PNorm = 41.4683, GNorm = 2.3875, lr_0 = 2.3596e-04
Loss = 5.2969e-03, PNorm = 41.4811, GNorm = 0.9576, lr_0 = 2.3209e-04
Loss = 8.2598e-03, PNorm = 41.4935, GNorm = 1.8004, lr_0 = 2.2828e-04
Validation rmse = 0.412147
Epoch 33
Loss = 8.3315e-03, PNorm = 41.5027, GNorm = 1.0715, lr_0 = 2.2454e-04
Loss = 8.1996e-03, PNorm = 41.5168, GNorm = 1.1624, lr_0 = 2.2086e-04
Loss = 7.2211e-03, PNorm = 41.5296, GNorm = 0.9690, lr_0 = 2.1723e-04
Validation rmse = 0.402925
Epoch 34
Loss = 7.8433e-03, PNorm = 41.5408, GNorm = 0.8145, lr_0 = 2.1367e-04
Loss = 7.1783e-03, PNorm = 41.5547, GNorm = 2.5251, lr_0 = 2.1016e-04
Loss = 7.5680e-03, PNorm = 41.5696, GNorm = 2.1046, lr_0 = 2.0672e-04
Validation rmse = 0.408416
Epoch 35
Loss = 6.0674e-03, PNorm = 41.5793, GNorm = 1.0679, lr_0 = 2.0332e-04
Loss = 8.9890e-03, PNorm = 41.5896, GNorm = 0.7197, lr_0 = 1.9999e-04
Loss = 6.6895e-03, PNorm = 41.6004, GNorm = 1.3905, lr_0 = 1.9671e-04
Validation rmse = 0.408800
Epoch 36
Loss = 7.5319e-03, PNorm = 41.6145, GNorm = 1.1178, lr_0 = 1.9348e-04
Loss = 7.2404e-03, PNorm = 41.6263, GNorm = 1.0420, lr_0 = 1.9031e-04
Loss = 6.7581e-03, PNorm = 41.6343, GNorm = 1.3369, lr_0 = 1.8718e-04
Validation rmse = 0.412798
Epoch 37
Loss = 7.1273e-03, PNorm = 41.6455, GNorm = 1.2028, lr_0 = 1.8411e-04
Loss = 7.1486e-03, PNorm = 41.6573, GNorm = 1.2811, lr_0 = 1.8109e-04
Loss = 7.3064e-03, PNorm = 41.6660, GNorm = 1.3387, lr_0 = 1.7812e-04
Validation rmse = 0.408845
Epoch 38
Loss = 6.0630e-03, PNorm = 41.6738, GNorm = 1.6903, lr_0 = 1.7520e-04
Loss = 8.8404e-03, PNorm = 41.6801, GNorm = 1.6198, lr_0 = 1.7233e-04
Loss = 6.6855e-03, PNorm = 41.6951, GNorm = 1.8033, lr_0 = 1.6950e-04
Validation rmse = 0.411316
Epoch 39
Loss = 7.6565e-03, PNorm = 41.7063, GNorm = 0.6843, lr_0 = 1.6672e-04
Loss = 7.1586e-03, PNorm = 41.7162, GNorm = 2.0154, lr_0 = 1.6398e-04
Loss = 6.4425e-03, PNorm = 41.7241, GNorm = 1.1401, lr_0 = 1.6129e-04
Validation rmse = 0.407861
Epoch 40
Loss = 5.5108e-03, PNorm = 41.7316, GNorm = 1.1215, lr_0 = 1.5865e-04
Loss = 8.4680e-03, PNorm = 41.7402, GNorm = 0.9686, lr_0 = 1.5604e-04
Validation rmse = 0.408329
Epoch 41
Loss = 7.4351e-03, PNorm = 41.7485, GNorm = 1.6661, lr_0 = 1.5348e-04
Loss = 5.8195e-03, PNorm = 41.7568, GNorm = 1.0244, lr_0 = 1.5097e-04
Loss = 7.5270e-03, PNorm = 41.7664, GNorm = 1.2769, lr_0 = 1.4849e-04
Validation rmse = 0.409364
Epoch 42
Loss = 7.6803e-03, PNorm = 41.7721, GNorm = 0.9899, lr_0 = 1.4605e-04
Loss = 7.2807e-03, PNorm = 41.7810, GNorm = 1.4793, lr_0 = 1.4366e-04
Loss = 6.1837e-03, PNorm = 41.7895, GNorm = 1.1883, lr_0 = 1.4130e-04
Validation rmse = 0.408066
Epoch 43
Loss = 6.3664e-03, PNorm = 41.7971, GNorm = 1.4632, lr_0 = 1.3898e-04
Loss = 6.9974e-03, PNorm = 41.8034, GNorm = 0.7115, lr_0 = 1.3670e-04
Loss = 7.1496e-03, PNorm = 41.8094, GNorm = 1.7697, lr_0 = 1.3446e-04
Validation rmse = 0.412763
Epoch 44
Loss = 5.9276e-03, PNorm = 41.8173, GNorm = 2.3870, lr_0 = 1.3225e-04
Loss = 9.1378e-03, PNorm = 41.8255, GNorm = 2.3572, lr_0 = 1.3008e-04
Loss = 5.6555e-03, PNorm = 41.8327, GNorm = 0.9489, lr_0 = 1.2795e-04
Validation rmse = 0.409515
Epoch 45
Loss = 4.3861e-03, PNorm = 41.8404, GNorm = 1.4581, lr_0 = 1.2585e-04
Loss = 7.4195e-03, PNorm = 41.8459, GNorm = 1.2883, lr_0 = 1.2379e-04
Loss = 7.3966e-03, PNorm = 41.8532, GNorm = 2.1358, lr_0 = 1.2176e-04
Validation rmse = 0.408322
Epoch 46
Loss = 5.0827e-03, PNorm = 41.8582, GNorm = 1.6932, lr_0 = 1.1976e-04
Loss = 6.8477e-03, PNorm = 41.8623, GNorm = 1.6248, lr_0 = 1.1779e-04
Loss = 7.0916e-03, PNorm = 41.8715, GNorm = 1.1675, lr_0 = 1.1586e-04
Validation rmse = 0.409544
Epoch 47
Loss = 7.2525e-03, PNorm = 41.8794, GNorm = 1.4238, lr_0 = 1.1396e-04
Loss = 6.2630e-03, PNorm = 41.8865, GNorm = 2.5146, lr_0 = 1.1209e-04
Loss = 7.4084e-03, PNorm = 41.8906, GNorm = 1.5333, lr_0 = 1.1025e-04
Validation rmse = 0.408433
Epoch 48
Loss = 6.6710e-03, PNorm = 41.8961, GNorm = 1.9498, lr_0 = 1.0844e-04
Loss = 5.7099e-03, PNorm = 41.9046, GNorm = 0.8687, lr_0 = 1.0666e-04
Loss = 8.2662e-03, PNorm = 41.9080, GNorm = 0.9349, lr_0 = 1.0491e-04
Validation rmse = 0.408496
Epoch 49
Loss = 7.1701e-03, PNorm = 41.9135, GNorm = 1.5179, lr_0 = 1.0319e-04
Loss = 7.0481e-03, PNorm = 41.9194, GNorm = 0.9299, lr_0 = 1.0150e-04
Loss = 6.0172e-03, PNorm = 41.9241, GNorm = 0.6855, lr_0 = 1.0000e-04
Validation rmse = 0.408474
Model 0 best validation rmse = 0.402925 on epoch 33
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.937728
Ensemble test rmse = 0.937728
1-fold cross validation
Seed 5 ==> test rmse = 0.937728
Overall test rmse = 0.937728 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 451 | train size = 451 | val size = 113 | test size = 2,444
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=310, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 448,201
Epoch 0
Validation rmse = 1.105953
Epoch 1
Loss = 1.6192e-02, PNorm = 38.1769, GNorm = 2.7573, lr_0 = 6.5000e-04
Validation rmse = 0.955208
Epoch 2
Loss = 1.4363e-02, PNorm = 38.2085, GNorm = 3.8417, lr_0 = 9.8414e-04
Validation rmse = 0.887259
Epoch 3
Loss = 1.1149e-02, PNorm = 38.2649, GNorm = 5.0571, lr_0 = 9.3306e-04
Validation rmse = 0.861338
Epoch 4
Loss = 1.0151e-02, PNorm = 38.3013, GNorm = 2.0934, lr_0 = 8.8463e-04
Validation rmse = 0.903818
Epoch 5
Loss = 1.2273e-02, PNorm = 38.3451, GNorm = 4.6427, lr_0 = 8.3871e-04
Validation rmse = 0.932635
Epoch 6
Loss = 1.1178e-02, PNorm = 38.3707, GNorm = 1.8170, lr_0 = 7.9518e-04
Validation rmse = 0.938005
Epoch 7
Loss = 1.0408e-02, PNorm = 38.4102, GNorm = 1.6267, lr_0 = 7.5390e-04
Validation rmse = 0.795967
Epoch 8
Loss = 9.1336e-03, PNorm = 38.4547, GNorm = 1.9451, lr_0 = 7.1477e-04
Validation rmse = 0.777943
Epoch 9
Loss = 9.4956e-03, PNorm = 38.5011, GNorm = 0.9655, lr_0 = 6.7767e-04
Validation rmse = 0.775986
Epoch 10
Validation rmse = 0.748013
Epoch 11
Loss = 7.2478e-03, PNorm = 38.5464, GNorm = 1.9139, lr_0 = 6.4250e-04
Validation rmse = 0.746720
Epoch 12
Loss = 7.2491e-03, PNorm = 38.5947, GNorm = 1.2234, lr_0 = 6.0915e-04
Validation rmse = 0.738621
Epoch 13
Loss = 7.5702e-03, PNorm = 38.6415, GNorm = 0.9885, lr_0 = 5.7753e-04
Validation rmse = 0.726218
Epoch 14
Loss = 7.3328e-03, PNorm = 38.6805, GNorm = 1.5361, lr_0 = 5.4755e-04
Validation rmse = 0.713109
Epoch 15
Loss = 7.7858e-03, PNorm = 38.7182, GNorm = 1.2311, lr_0 = 5.1913e-04
Validation rmse = 0.696245
Epoch 16
Loss = 6.6141e-03, PNorm = 38.7596, GNorm = 0.9283, lr_0 = 4.9219e-04
Validation rmse = 0.685759
Epoch 17
Loss = 6.1447e-03, PNorm = 38.7945, GNorm = 0.8482, lr_0 = 4.6664e-04
Validation rmse = 0.669052
Epoch 18
Loss = 6.4916e-03, PNorm = 38.8257, GNorm = 3.1136, lr_0 = 4.4242e-04
Validation rmse = 0.677383
Epoch 19
Loss = 6.2850e-03, PNorm = 38.8555, GNorm = 1.4243, lr_0 = 4.1945e-04
Validation rmse = 0.671731
Epoch 20
Validation rmse = 0.655582
Epoch 21
Loss = 6.0860e-03, PNorm = 38.8833, GNorm = 1.0018, lr_0 = 3.9768e-04
Validation rmse = 0.646621
Epoch 22
Loss = 5.4402e-03, PNorm = 38.9138, GNorm = 0.6561, lr_0 = 3.7704e-04
Validation rmse = 0.649903
Epoch 23
Loss = 5.8939e-03, PNorm = 38.9407, GNorm = 0.9826, lr_0 = 3.5747e-04
Validation rmse = 0.635620
Epoch 24
Loss = 5.3571e-03, PNorm = 38.9634, GNorm = 0.9934, lr_0 = 3.3892e-04
Validation rmse = 0.648902
Epoch 25
Loss = 6.3117e-03, PNorm = 38.9839, GNorm = 0.8862, lr_0 = 3.2132e-04
Validation rmse = 0.653264
Epoch 26
Loss = 6.4651e-03, PNorm = 39.0061, GNorm = 2.9891, lr_0 = 3.0465e-04
Validation rmse = 0.632586
Epoch 27
Loss = 5.2872e-03, PNorm = 39.0258, GNorm = 1.3444, lr_0 = 2.8883e-04
Validation rmse = 0.633114
Epoch 28
Loss = 5.7596e-03, PNorm = 39.0459, GNorm = 0.7301, lr_0 = 2.7384e-04
Validation rmse = 0.632950
Epoch 29
Loss = 5.6086e-03, PNorm = 39.0643, GNorm = 1.1098, lr_0 = 2.5963e-04
Validation rmse = 0.638682
Epoch 30
Validation rmse = 0.625584
Epoch 31
Loss = 5.4363e-03, PNorm = 39.0817, GNorm = 1.0758, lr_0 = 2.4615e-04
Validation rmse = 0.632997
Epoch 32
Loss = 6.4826e-03, PNorm = 39.0966, GNorm = 1.9711, lr_0 = 2.3338e-04
Validation rmse = 0.627963
Epoch 33
Loss = 5.2350e-03, PNorm = 39.1120, GNorm = 1.1310, lr_0 = 2.2126e-04
Validation rmse = 0.622116
Epoch 34
Loss = 4.8822e-03, PNorm = 39.1265, GNorm = 0.9124, lr_0 = 2.0978e-04
Validation rmse = 0.641412
Epoch 35
Loss = 4.8606e-03, PNorm = 39.1387, GNorm = 1.0178, lr_0 = 1.9889e-04
Validation rmse = 0.624807
Epoch 36
Loss = 5.4350e-03, PNorm = 39.1517, GNorm = 0.9764, lr_0 = 1.8857e-04
Validation rmse = 0.614226
Epoch 37
Loss = 5.2665e-03, PNorm = 39.1639, GNorm = 2.0247, lr_0 = 1.7878e-04
Validation rmse = 0.619865
Epoch 38
Loss = 5.5760e-03, PNorm = 39.1757, GNorm = 1.3105, lr_0 = 1.6950e-04
Validation rmse = 0.619497
Epoch 39
Loss = 5.1170e-03, PNorm = 39.1877, GNorm = 1.9363, lr_0 = 1.6070e-04
Validation rmse = 0.635401
Epoch 40
Validation rmse = 0.618951
Epoch 41
Loss = 5.0949e-03, PNorm = 39.1978, GNorm = 0.8173, lr_0 = 1.5236e-04
Validation rmse = 0.617137
Epoch 42
Loss = 4.8506e-03, PNorm = 39.2070, GNorm = 1.6282, lr_0 = 1.4445e-04
Validation rmse = 0.625902
Epoch 43
Loss = 5.1961e-03, PNorm = 39.2153, GNorm = 1.5212, lr_0 = 1.3695e-04
Validation rmse = 0.624709
Epoch 44
Loss = 4.6630e-03, PNorm = 39.2234, GNorm = 2.8971, lr_0 = 1.2985e-04
Validation rmse = 0.637968
Epoch 45
Loss = 5.3209e-03, PNorm = 39.2320, GNorm = 1.7056, lr_0 = 1.2311e-04
Validation rmse = 0.623061
Epoch 46
Loss = 5.2024e-03, PNorm = 39.2401, GNorm = 0.7657, lr_0 = 1.1672e-04
Validation rmse = 0.629940
Epoch 47
Loss = 4.5053e-03, PNorm = 39.2471, GNorm = 1.1832, lr_0 = 1.1066e-04
Validation rmse = 0.610106
Epoch 48
Loss = 4.8611e-03, PNorm = 39.2547, GNorm = 1.3287, lr_0 = 1.0491e-04
Validation rmse = 0.617791
Epoch 49
Loss = 4.8473e-03, PNorm = 39.2611, GNorm = 0.9670, lr_0 = 1.0000e-04
Validation rmse = 0.613963
Model 0 best validation rmse = 0.610106 on epoch 47
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.929539
Ensemble test rmse = 0.929539
1-fold cross validation
Seed 5 ==> test rmse = 0.929539
Overall test rmse = 0.929539 +/- 0.000000
