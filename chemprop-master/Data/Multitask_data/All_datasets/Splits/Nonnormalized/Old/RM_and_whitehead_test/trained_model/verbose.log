Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 50,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/RM_and_whitehead_test/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 451 | train size = 451 | val size = 113 | test size = 2,444
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=310, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 448,201
Epoch 0
Validation rmse = 1.105953
Epoch 1
Loss = 1.6192e-02, PNorm = 38.1769, GNorm = 2.7573, lr_0 = 6.5000e-04
Validation rmse = 0.955208
Epoch 2
Loss = 1.4363e-02, PNorm = 38.2085, GNorm = 3.8417, lr_0 = 9.8414e-04
Validation rmse = 0.887259
Epoch 3
Loss = 1.1149e-02, PNorm = 38.2649, GNorm = 5.0571, lr_0 = 9.3306e-04
Validation rmse = 0.861338
Epoch 4
Loss = 1.0151e-02, PNorm = 38.3013, GNorm = 2.0934, lr_0 = 8.8463e-04
Validation rmse = 0.903818
Epoch 5
Loss = 1.2273e-02, PNorm = 38.3451, GNorm = 4.6427, lr_0 = 8.3871e-04
Validation rmse = 0.932635
Epoch 6
Loss = 1.1178e-02, PNorm = 38.3707, GNorm = 1.8170, lr_0 = 7.9518e-04
Validation rmse = 0.938005
Epoch 7
Loss = 1.0408e-02, PNorm = 38.4102, GNorm = 1.6267, lr_0 = 7.5390e-04
Validation rmse = 0.795967
Epoch 8
Loss = 9.1336e-03, PNorm = 38.4547, GNorm = 1.9451, lr_0 = 7.1477e-04
Validation rmse = 0.777943
Epoch 9
Loss = 9.4956e-03, PNorm = 38.5011, GNorm = 0.9655, lr_0 = 6.7767e-04
Validation rmse = 0.775986
Epoch 10
Validation rmse = 0.748013
Epoch 11
Loss = 7.2478e-03, PNorm = 38.5464, GNorm = 1.9139, lr_0 = 6.4250e-04
Validation rmse = 0.746720
Epoch 12
Loss = 7.2491e-03, PNorm = 38.5947, GNorm = 1.2234, lr_0 = 6.0915e-04
Validation rmse = 0.738621
Epoch 13
Loss = 7.5702e-03, PNorm = 38.6415, GNorm = 0.9885, lr_0 = 5.7753e-04
Validation rmse = 0.726218
Epoch 14
Loss = 7.3328e-03, PNorm = 38.6805, GNorm = 1.5361, lr_0 = 5.4755e-04
Validation rmse = 0.713109
Epoch 15
Loss = 7.7858e-03, PNorm = 38.7182, GNorm = 1.2311, lr_0 = 5.1913e-04
Validation rmse = 0.696245
Epoch 16
Loss = 6.6141e-03, PNorm = 38.7596, GNorm = 0.9283, lr_0 = 4.9219e-04
Validation rmse = 0.685759
Epoch 17
Loss = 6.1447e-03, PNorm = 38.7945, GNorm = 0.8482, lr_0 = 4.6664e-04
Validation rmse = 0.669052
Epoch 18
Loss = 6.4916e-03, PNorm = 38.8257, GNorm = 3.1136, lr_0 = 4.4242e-04
Validation rmse = 0.677383
Epoch 19
Loss = 6.2850e-03, PNorm = 38.8555, GNorm = 1.4243, lr_0 = 4.1945e-04
Validation rmse = 0.671731
Epoch 20
Validation rmse = 0.655582
Epoch 21
Loss = 6.0860e-03, PNorm = 38.8833, GNorm = 1.0018, lr_0 = 3.9768e-04
Validation rmse = 0.646621
Epoch 22
Loss = 5.4402e-03, PNorm = 38.9138, GNorm = 0.6561, lr_0 = 3.7704e-04
Validation rmse = 0.649903
Epoch 23
Loss = 5.8939e-03, PNorm = 38.9407, GNorm = 0.9826, lr_0 = 3.5747e-04
Validation rmse = 0.635620
Epoch 24
Loss = 5.3571e-03, PNorm = 38.9634, GNorm = 0.9934, lr_0 = 3.3892e-04
Validation rmse = 0.648902
Epoch 25
Loss = 6.3117e-03, PNorm = 38.9839, GNorm = 0.8862, lr_0 = 3.2132e-04
Validation rmse = 0.653264
Epoch 26
Loss = 6.4651e-03, PNorm = 39.0061, GNorm = 2.9891, lr_0 = 3.0465e-04
Validation rmse = 0.632586
Epoch 27
Loss = 5.2872e-03, PNorm = 39.0258, GNorm = 1.3444, lr_0 = 2.8883e-04
Validation rmse = 0.633114
Epoch 28
Loss = 5.7596e-03, PNorm = 39.0459, GNorm = 0.7301, lr_0 = 2.7384e-04
Validation rmse = 0.632950
Epoch 29
Loss = 5.6086e-03, PNorm = 39.0643, GNorm = 1.1098, lr_0 = 2.5963e-04
Validation rmse = 0.638682
Epoch 30
Validation rmse = 0.625584
Epoch 31
Loss = 5.4363e-03, PNorm = 39.0817, GNorm = 1.0758, lr_0 = 2.4615e-04
Validation rmse = 0.632997
Epoch 32
Loss = 6.4826e-03, PNorm = 39.0966, GNorm = 1.9711, lr_0 = 2.3338e-04
Validation rmse = 0.627963
Epoch 33
Loss = 5.2350e-03, PNorm = 39.1120, GNorm = 1.1310, lr_0 = 2.2126e-04
Validation rmse = 0.622116
Epoch 34
Loss = 4.8822e-03, PNorm = 39.1265, GNorm = 0.9124, lr_0 = 2.0978e-04
Validation rmse = 0.641412
Epoch 35
Loss = 4.8606e-03, PNorm = 39.1387, GNorm = 1.0178, lr_0 = 1.9889e-04
Validation rmse = 0.624807
Epoch 36
Loss = 5.4350e-03, PNorm = 39.1517, GNorm = 0.9764, lr_0 = 1.8857e-04
Validation rmse = 0.614226
Epoch 37
Loss = 5.2665e-03, PNorm = 39.1639, GNorm = 2.0247, lr_0 = 1.7878e-04
Validation rmse = 0.619865
Epoch 38
Loss = 5.5760e-03, PNorm = 39.1757, GNorm = 1.3105, lr_0 = 1.6950e-04
Validation rmse = 0.619497
Epoch 39
Loss = 5.1170e-03, PNorm = 39.1877, GNorm = 1.9363, lr_0 = 1.6070e-04
Validation rmse = 0.635401
Epoch 40
Validation rmse = 0.618951
Epoch 41
Loss = 5.0949e-03, PNorm = 39.1978, GNorm = 0.8173, lr_0 = 1.5236e-04
Validation rmse = 0.617137
Epoch 42
Loss = 4.8506e-03, PNorm = 39.2070, GNorm = 1.6282, lr_0 = 1.4445e-04
Validation rmse = 0.625902
Epoch 43
Loss = 5.1961e-03, PNorm = 39.2153, GNorm = 1.5212, lr_0 = 1.3695e-04
Validation rmse = 0.624709
Epoch 44
Loss = 4.6630e-03, PNorm = 39.2234, GNorm = 2.8971, lr_0 = 1.2985e-04
Validation rmse = 0.637968
Epoch 45
Loss = 5.3209e-03, PNorm = 39.2320, GNorm = 1.7056, lr_0 = 1.2311e-04
Validation rmse = 0.623061
Epoch 46
Loss = 5.2024e-03, PNorm = 39.2401, GNorm = 0.7657, lr_0 = 1.1672e-04
Validation rmse = 0.629940
Epoch 47
Loss = 4.5053e-03, PNorm = 39.2471, GNorm = 1.1832, lr_0 = 1.1066e-04
Validation rmse = 0.610106
Epoch 48
Loss = 4.8611e-03, PNorm = 39.2547, GNorm = 1.3287, lr_0 = 1.0491e-04
Validation rmse = 0.617791
Epoch 49
Loss = 4.8473e-03, PNorm = 39.2611, GNorm = 0.9670, lr_0 = 1.0000e-04
Validation rmse = 0.613963
Model 0 best validation rmse = 0.610106 on epoch 47
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.929539
Ensemble test rmse = 0.929539
1-fold cross validation
Seed 5 ==> test rmse = 0.929539
Overall test rmse = 0.929539 +/- 0.000000
