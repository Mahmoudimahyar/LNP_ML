Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 40,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,443 | train size = 1,443 | val size = 450 | test size = 326
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=326, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 453,001
Epoch 0
Loss = 2.1515e-02, PNorm = 38.2332, GNorm = 4.1486, lr_0 = 2.7679e-04
Loss = 1.7354e-02, PNorm = 38.2407, GNorm = 2.3703, lr_0 = 4.3750e-04
Validation rmse = 1.231415
Epoch 1
Loss = 1.4257e-02, PNorm = 38.2622, GNorm = 0.8861, lr_0 = 5.9821e-04
Loss = 1.5911e-02, PNorm = 38.3033, GNorm = 5.2549, lr_0 = 7.5893e-04
Loss = 1.5439e-02, PNorm = 38.3466, GNorm = 3.2250, lr_0 = 9.1964e-04
Validation rmse = 1.094870
Epoch 2
Loss = 1.0556e-02, PNorm = 38.4175, GNorm = 1.5122, lr_0 = 9.8924e-04
Loss = 1.0389e-02, PNorm = 38.4855, GNorm = 1.8179, lr_0 = 9.6806e-04
Loss = 9.1495e-03, PNorm = 38.5386, GNorm = 2.8834, lr_0 = 9.4734e-04
Validation rmse = 1.075769
Epoch 3
Loss = 1.1065e-02, PNorm = 38.5929, GNorm = 1.5813, lr_0 = 9.2705e-04
Loss = 8.3128e-03, PNorm = 38.6517, GNorm = 1.7423, lr_0 = 9.0721e-04
Loss = 8.1264e-03, PNorm = 38.6879, GNorm = 1.7739, lr_0 = 8.8779e-04
Validation rmse = 1.024663
Epoch 4
Loss = 7.8775e-03, PNorm = 38.7289, GNorm = 0.3592, lr_0 = 8.6878e-04
Loss = 8.1540e-03, PNorm = 38.7682, GNorm = 4.5079, lr_0 = 8.5018e-04
Loss = 7.5374e-03, PNorm = 38.7973, GNorm = 3.8711, lr_0 = 8.3198e-04
Validation rmse = 0.982931
Epoch 5
Loss = 7.2130e-03, PNorm = 38.8321, GNorm = 1.1868, lr_0 = 8.1417e-04
Loss = 8.6439e-03, PNorm = 38.8726, GNorm = 1.1132, lr_0 = 7.9674e-04
Validation rmse = 1.085978
Epoch 6
Loss = 8.2125e-03, PNorm = 38.9100, GNorm = 0.6809, lr_0 = 7.7968e-04
Loss = 8.5406e-03, PNorm = 38.9533, GNorm = 1.5154, lr_0 = 7.6299e-04
Loss = 7.1977e-03, PNorm = 39.0018, GNorm = 1.3345, lr_0 = 7.4666e-04
Validation rmse = 0.975209
Epoch 7
Loss = 7.9338e-03, PNorm = 39.0392, GNorm = 1.4703, lr_0 = 7.3067e-04
Loss = 7.3968e-03, PNorm = 39.0731, GNorm = 1.3001, lr_0 = 7.1503e-04
Loss = 6.5084e-03, PNorm = 39.0994, GNorm = 2.0652, lr_0 = 6.9972e-04
Validation rmse = 1.001471
Epoch 8
Loss = 6.6757e-03, PNorm = 39.1282, GNorm = 1.4458, lr_0 = 6.8474e-04
Loss = 7.1756e-03, PNorm = 39.1567, GNorm = 1.9855, lr_0 = 6.7008e-04
Loss = 5.9727e-03, PNorm = 39.1781, GNorm = 0.4813, lr_0 = 6.5574e-04
Validation rmse = 0.942682
Epoch 9
Loss = 7.1016e-03, PNorm = 39.2019, GNorm = 1.5730, lr_0 = 6.4170e-04
Loss = 6.5075e-03, PNorm = 39.2232, GNorm = 1.7034, lr_0 = 6.2796e-04
Loss = 6.4810e-03, PNorm = 39.2465, GNorm = 1.7155, lr_0 = 6.1452e-04
Validation rmse = 0.937297
Epoch 10
Loss = 6.7369e-03, PNorm = 39.2711, GNorm = 1.6501, lr_0 = 6.0136e-04
Loss = 6.4888e-03, PNorm = 39.3000, GNorm = 0.5249, lr_0 = 5.8849e-04
Validation rmse = 0.974911
Epoch 11
Loss = 5.0155e-03, PNorm = 39.3222, GNorm = 1.1195, lr_0 = 5.7589e-04
Loss = 6.5582e-03, PNorm = 39.3489, GNorm = 1.3411, lr_0 = 5.6356e-04
Loss = 6.9870e-03, PNorm = 39.3751, GNorm = 1.3751, lr_0 = 5.5149e-04
Validation rmse = 0.942582
Epoch 12
Loss = 6.6205e-03, PNorm = 39.4046, GNorm = 2.3457, lr_0 = 5.3969e-04
Loss = 5.8021e-03, PNorm = 39.4216, GNorm = 1.7824, lr_0 = 5.2813e-04
Loss = 7.1668e-03, PNorm = 39.4407, GNorm = 0.9851, lr_0 = 5.1683e-04
Validation rmse = 0.933587
Epoch 13
Loss = 6.1579e-03, PNorm = 39.4645, GNorm = 0.8315, lr_0 = 5.0576e-04
Loss = 7.2002e-03, PNorm = 39.4856, GNorm = 1.0980, lr_0 = 4.9494e-04
Loss = 6.2483e-03, PNorm = 39.5075, GNorm = 1.0664, lr_0 = 4.8434e-04
Validation rmse = 0.986019
Epoch 14
Loss = 6.3261e-03, PNorm = 39.5308, GNorm = 0.8261, lr_0 = 4.7397e-04
Loss = 6.2293e-03, PNorm = 39.5535, GNorm = 1.0403, lr_0 = 4.6382e-04
Loss = 6.8225e-03, PNorm = 39.5693, GNorm = 2.6041, lr_0 = 4.5389e-04
Validation rmse = 0.988919
Epoch 15
Loss = 5.8568e-03, PNorm = 39.5892, GNorm = 0.8336, lr_0 = 4.4418e-04
Loss = 6.7007e-03, PNorm = 39.6101, GNorm = 0.6273, lr_0 = 4.3467e-04
Validation rmse = 0.990877
Epoch 16
Loss = 7.4377e-03, PNorm = 39.6253, GNorm = 1.1918, lr_0 = 4.2536e-04
Loss = 6.6448e-03, PNorm = 39.6448, GNorm = 0.8003, lr_0 = 4.1626e-04
Loss = 5.7185e-03, PNorm = 39.6643, GNorm = 0.6454, lr_0 = 4.0735e-04
Validation rmse = 1.023298
Epoch 17
Loss = 6.0989e-03, PNorm = 39.6838, GNorm = 0.4901, lr_0 = 3.9862e-04
Loss = 5.2736e-03, PNorm = 39.6976, GNorm = 0.8164, lr_0 = 3.9009e-04
Loss = 6.8396e-03, PNorm = 39.7120, GNorm = 1.6518, lr_0 = 3.8174e-04
Validation rmse = 1.019978
Epoch 18
Loss = 6.9205e-03, PNorm = 39.7354, GNorm = 0.3617, lr_0 = 3.7357e-04
Loss = 6.0489e-03, PNorm = 39.7509, GNorm = 0.6894, lr_0 = 3.6557e-04
Loss = 5.8884e-03, PNorm = 39.7686, GNorm = 1.0668, lr_0 = 3.5774e-04
Validation rmse = 1.075934
Epoch 19
Loss = 5.7813e-03, PNorm = 39.7908, GNorm = 1.0411, lr_0 = 3.5008e-04
Loss = 6.1710e-03, PNorm = 39.8067, GNorm = 0.5132, lr_0 = 3.4259e-04
Loss = 5.9039e-03, PNorm = 39.8249, GNorm = 1.2984, lr_0 = 3.3526e-04
Validation rmse = 1.035326
Epoch 20
Loss = 6.0699e-03, PNorm = 39.8378, GNorm = 1.7493, lr_0 = 3.2808e-04
Loss = 5.9152e-03, PNorm = 39.8549, GNorm = 0.4988, lr_0 = 3.2105e-04
Validation rmse = 1.030502
Epoch 21
Loss = 7.8330e-03, PNorm = 39.8695, GNorm = 1.6286, lr_0 = 3.1418e-04
Loss = 5.3046e-03, PNorm = 39.8840, GNorm = 0.6675, lr_0 = 3.0746e-04
Loss = 6.0933e-03, PNorm = 39.8977, GNorm = 0.9001, lr_0 = 3.0087e-04
Validation rmse = 1.113735
Epoch 22
Loss = 6.8760e-03, PNorm = 39.9108, GNorm = 1.9884, lr_0 = 2.9443e-04
Loss = 5.2793e-03, PNorm = 39.9264, GNorm = 0.8261, lr_0 = 2.8813e-04
Loss = 6.4495e-03, PNorm = 39.9388, GNorm = 1.9571, lr_0 = 2.8196e-04
Validation rmse = 1.091403
Epoch 23
Loss = 5.3190e-03, PNorm = 39.9456, GNorm = 0.6367, lr_0 = 2.7592e-04
Loss = 6.1040e-03, PNorm = 39.9621, GNorm = 0.8565, lr_0 = 2.7002e-04
Loss = 5.2894e-03, PNorm = 39.9752, GNorm = 0.3569, lr_0 = 2.6424e-04
Validation rmse = 1.031920
Epoch 24
Loss = 6.2348e-03, PNorm = 39.9896, GNorm = 0.5064, lr_0 = 2.5858e-04
Loss = 5.1861e-03, PNorm = 40.0038, GNorm = 1.4943, lr_0 = 2.5304e-04
Loss = 5.3793e-03, PNorm = 40.0112, GNorm = 1.0237, lr_0 = 2.4763e-04
Validation rmse = 1.108373
Epoch 25
Loss = 5.3546e-03, PNorm = 40.0196, GNorm = 1.3302, lr_0 = 2.4233e-04
Loss = 5.4139e-03, PNorm = 40.0315, GNorm = 1.1358, lr_0 = 2.3714e-04
Validation rmse = 1.063306
Epoch 26
Loss = 7.2594e-03, PNorm = 40.0442, GNorm = 0.8387, lr_0 = 2.3206e-04
Loss = 6.0975e-03, PNorm = 40.0538, GNorm = 0.9857, lr_0 = 2.2709e-04
Loss = 5.2476e-03, PNorm = 40.0662, GNorm = 1.3981, lr_0 = 2.2223e-04
Validation rmse = 1.114664
Epoch 27
Loss = 5.3565e-03, PNorm = 40.0774, GNorm = 1.1095, lr_0 = 2.1747e-04
Loss = 6.1902e-03, PNorm = 40.0850, GNorm = 1.2078, lr_0 = 2.1282e-04
Loss = 5.5297e-03, PNorm = 40.0981, GNorm = 0.7834, lr_0 = 2.0826e-04
Validation rmse = 1.117050
Epoch 28
Loss = 6.0924e-03, PNorm = 40.1085, GNorm = 1.2736, lr_0 = 2.0380e-04
Loss = 5.4018e-03, PNorm = 40.1143, GNorm = 1.1890, lr_0 = 1.9944e-04
Loss = 5.6278e-03, PNorm = 40.1252, GNorm = 2.4807, lr_0 = 1.9517e-04
Validation rmse = 1.130057
Epoch 29
Loss = 5.3884e-03, PNorm = 40.1318, GNorm = 1.2485, lr_0 = 1.9099e-04
Loss = 5.8393e-03, PNorm = 40.1424, GNorm = 0.7591, lr_0 = 1.8690e-04
Loss = 5.2222e-03, PNorm = 40.1510, GNorm = 1.4790, lr_0 = 1.8290e-04
Validation rmse = 1.155578
Epoch 30
Loss = 5.7743e-03, PNorm = 40.1576, GNorm = 0.7108, lr_0 = 1.7899e-04
Loss = 5.0738e-03, PNorm = 40.1669, GNorm = 1.1813, lr_0 = 1.7515e-04
Validation rmse = 1.186600
Epoch 31
Loss = 5.4480e-03, PNorm = 40.1754, GNorm = 1.7701, lr_0 = 1.7140e-04
Loss = 5.4368e-03, PNorm = 40.1844, GNorm = 1.5234, lr_0 = 1.6774e-04
Loss = 5.1851e-03, PNorm = 40.1941, GNorm = 0.6551, lr_0 = 1.6414e-04
Validation rmse = 1.093861
Epoch 32
Loss = 5.1933e-03, PNorm = 40.2009, GNorm = 1.2328, lr_0 = 1.6063e-04
Loss = 5.3321e-03, PNorm = 40.2100, GNorm = 0.9703, lr_0 = 1.5719e-04
Loss = 5.0730e-03, PNorm = 40.2154, GNorm = 0.6863, lr_0 = 1.5383e-04
Validation rmse = 1.187611
Epoch 33
Loss = 5.0737e-03, PNorm = 40.2195, GNorm = 0.9678, lr_0 = 1.5053e-04
Loss = 5.4364e-03, PNorm = 40.2228, GNorm = 0.5318, lr_0 = 1.4731e-04
Loss = 5.5346e-03, PNorm = 40.2280, GNorm = 0.4646, lr_0 = 1.4416e-04
Validation rmse = 1.118579
Epoch 34
Loss = 4.6337e-03, PNorm = 40.2368, GNorm = 1.3893, lr_0 = 1.4107e-04
Loss = 5.5302e-03, PNorm = 40.2412, GNorm = 1.2325, lr_0 = 1.3805e-04
Loss = 5.6076e-03, PNorm = 40.2479, GNorm = 1.2209, lr_0 = 1.3509e-04
Validation rmse = 1.183590
Epoch 35
Loss = 5.0026e-03, PNorm = 40.2566, GNorm = 1.5937, lr_0 = 1.3220e-04
Loss = 5.7432e-03, PNorm = 40.2639, GNorm = 0.5353, lr_0 = 1.2937e-04
Validation rmse = 1.140663
Epoch 36
Loss = 4.1342e-03, PNorm = 40.2688, GNorm = 1.1462, lr_0 = 1.2660e-04
Loss = 5.5085e-03, PNorm = 40.2738, GNorm = 1.0418, lr_0 = 1.2389e-04
Loss = 5.0333e-03, PNorm = 40.2796, GNorm = 0.3247, lr_0 = 1.2124e-04
Validation rmse = 1.167752
Epoch 37
Loss = 4.8709e-03, PNorm = 40.2838, GNorm = 1.1397, lr_0 = 1.1864e-04
Loss = 5.4907e-03, PNorm = 40.2895, GNorm = 1.2831, lr_0 = 1.1610e-04
Loss = 5.1117e-03, PNorm = 40.2944, GNorm = 0.5858, lr_0 = 1.1362e-04
Validation rmse = 1.122443
Epoch 38
Loss = 5.7461e-03, PNorm = 40.2974, GNorm = 2.2158, lr_0 = 1.1119e-04
Loss = 5.4354e-03, PNorm = 40.3026, GNorm = 1.3091, lr_0 = 1.0881e-04
Loss = 4.5801e-03, PNorm = 40.3084, GNorm = 0.7222, lr_0 = 1.0648e-04
Validation rmse = 1.154507
Epoch 39
Loss = 5.5225e-03, PNorm = 40.3117, GNorm = 1.7745, lr_0 = 1.0420e-04
Loss = 5.1366e-03, PNorm = 40.3170, GNorm = 0.6477, lr_0 = 1.0197e-04
Loss = 4.7031e-03, PNorm = 40.3202, GNorm = 1.1080, lr_0 = 1.0000e-04
Validation rmse = 1.134793
Model 0 best validation rmse = 0.933587 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.606616
Ensemble test rmse = 0.606616
1-fold cross validation
Seed 5 ==> test rmse = 0.606616
Overall test rmse = 0.606616 +/- 0.000000
