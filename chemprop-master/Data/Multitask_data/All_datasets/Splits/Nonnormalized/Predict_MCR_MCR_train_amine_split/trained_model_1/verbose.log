Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': False,
 'data_path': 'Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/train.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 40,
 'features_generator': None,
 'features_only': False,
 'features_path': ['Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/train_extra_x.csv'],
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/trained_model/fold_0',
 'save_smiles_splits': False,
 'seed': 5,
 'separate_test_features_path': ['Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/test_extra_x.csv'],
 'separate_test_path': 'Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/test.csv',
 'separate_val_features_path': ['Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/valid_extra_x.csv'],
 'separate_val_path': 'Data/Multitask_data/All_datasets/Splits/Predict_MCR_MCR_train_amine_split/valid.csv',
 'show_individual_scores': False,
 'split_sizes': [0.675, 0.075, 0.25],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 5
Total size = 1,446 | train size = 1,446 | val size = 323 | test size = 450
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=326, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=300, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 453,001
Epoch 0
Loss = 1.8794e-02, PNorm = 38.3017, GNorm = 3.7349, lr_0 = 2.7679e-04
Loss = 1.6154e-02, PNorm = 38.3128, GNorm = 2.7452, lr_0 = 4.3750e-04
Validation rmse = 1.320645
Epoch 1
Loss = 1.7638e-02, PNorm = 38.3328, GNorm = 3.9239, lr_0 = 5.9821e-04
Loss = 1.3361e-02, PNorm = 38.3796, GNorm = 5.7129, lr_0 = 7.5893e-04
Loss = 1.1963e-02, PNorm = 38.4411, GNorm = 3.9409, lr_0 = 9.1964e-04
Validation rmse = 1.166494
Epoch 2
Loss = 1.3104e-02, PNorm = 38.4896, GNorm = 1.0990, lr_0 = 9.8924e-04
Loss = 9.0290e-03, PNorm = 38.5388, GNorm = 4.6942, lr_0 = 9.6806e-04
Loss = 9.4867e-03, PNorm = 38.5824, GNorm = 1.5830, lr_0 = 9.4734e-04
Validation rmse = 1.238378
Epoch 3
Loss = 8.1308e-03, PNorm = 38.6120, GNorm = 1.3590, lr_0 = 9.2705e-04
Loss = 8.9043e-03, PNorm = 38.6443, GNorm = 5.9392, lr_0 = 9.0721e-04
Loss = 8.7221e-03, PNorm = 38.6796, GNorm = 4.5977, lr_0 = 8.8779e-04
Validation rmse = 1.465097
Epoch 4
Loss = 1.1261e-02, PNorm = 38.7249, GNorm = 4.0428, lr_0 = 8.6878e-04
Loss = 7.0846e-03, PNorm = 38.7694, GNorm = 2.1091, lr_0 = 8.5018e-04
Loss = 7.3985e-03, PNorm = 38.8126, GNorm = 1.4105, lr_0 = 8.3198e-04
Validation rmse = 1.192120
Epoch 5
Loss = 8.0664e-03, PNorm = 38.8433, GNorm = 1.9913, lr_0 = 8.1417e-04
Loss = 8.0850e-03, PNorm = 38.8739, GNorm = 0.5491, lr_0 = 7.9674e-04
Validation rmse = 1.155364
Epoch 6
Loss = 7.5051e-03, PNorm = 38.8991, GNorm = 1.0878, lr_0 = 7.7968e-04
Loss = 7.9534e-03, PNorm = 38.9253, GNorm = 1.3134, lr_0 = 7.6299e-04
Loss = 6.2059e-03, PNorm = 38.9462, GNorm = 1.9693, lr_0 = 7.4666e-04
Validation rmse = 1.172604
Epoch 7
Loss = 7.1152e-03, PNorm = 38.9616, GNorm = 0.6296, lr_0 = 7.3067e-04
Loss = 6.8550e-03, PNorm = 38.9829, GNorm = 0.9658, lr_0 = 7.1503e-04
Loss = 7.5676e-03, PNorm = 39.0045, GNorm = 2.0677, lr_0 = 6.9972e-04
Validation rmse = 1.030230
Epoch 8
Loss = 7.1639e-03, PNorm = 39.0267, GNorm = 2.5209, lr_0 = 6.8474e-04
Loss = 7.3188e-03, PNorm = 39.0524, GNorm = 1.6072, lr_0 = 6.7008e-04
Loss = 6.6872e-03, PNorm = 39.0808, GNorm = 0.8751, lr_0 = 6.5574e-04
Validation rmse = 1.121677
Epoch 9
Loss = 6.0488e-03, PNorm = 39.1000, GNorm = 1.1323, lr_0 = 6.4170e-04
Loss = 7.1161e-03, PNorm = 39.1180, GNorm = 0.9253, lr_0 = 6.2796e-04
Loss = 6.5459e-03, PNorm = 39.1390, GNorm = 2.0965, lr_0 = 6.1452e-04
Validation rmse = 1.065343
Epoch 10
Loss = 6.4004e-03, PNorm = 39.1540, GNorm = 1.4046, lr_0 = 6.0136e-04
Loss = 6.6428e-03, PNorm = 39.1773, GNorm = 1.8024, lr_0 = 5.8849e-04
Validation rmse = 1.063982
Epoch 11
Loss = 5.6867e-03, PNorm = 39.2082, GNorm = 1.3162, lr_0 = 5.7589e-04
Loss = 6.2124e-03, PNorm = 39.2297, GNorm = 0.7727, lr_0 = 5.6356e-04
Loss = 6.4587e-03, PNorm = 39.2464, GNorm = 1.9031, lr_0 = 5.5149e-04
Validation rmse = 1.194179
Epoch 12
Loss = 6.4455e-03, PNorm = 39.2700, GNorm = 0.9890, lr_0 = 5.3969e-04
Loss = 6.3452e-03, PNorm = 39.2889, GNorm = 1.6243, lr_0 = 5.2813e-04
Loss = 6.3639e-03, PNorm = 39.3086, GNorm = 0.6832, lr_0 = 5.1683e-04
Validation rmse = 1.247414
Epoch 13
Loss = 6.4181e-03, PNorm = 39.3269, GNorm = 1.0307, lr_0 = 5.0576e-04
Loss = 6.7503e-03, PNorm = 39.3501, GNorm = 1.2083, lr_0 = 4.9494e-04
Loss = 6.0264e-03, PNorm = 39.3692, GNorm = 1.1808, lr_0 = 4.8434e-04
Validation rmse = 1.350833
Epoch 14
Loss = 6.0001e-03, PNorm = 39.3856, GNorm = 1.5562, lr_0 = 4.7397e-04
Loss = 6.8585e-03, PNorm = 39.4026, GNorm = 1.7212, lr_0 = 4.6382e-04
Loss = 5.6722e-03, PNorm = 39.4211, GNorm = 1.9776, lr_0 = 4.5389e-04
Validation rmse = 1.215547
Epoch 15
Loss = 6.1414e-03, PNorm = 39.4425, GNorm = 1.3624, lr_0 = 4.4418e-04
Loss = 6.7374e-03, PNorm = 39.4577, GNorm = 1.3875, lr_0 = 4.3467e-04
Validation rmse = 1.145388
Epoch 16
Loss = 6.2222e-03, PNorm = 39.4771, GNorm = 1.5311, lr_0 = 4.2536e-04
Loss = 5.8789e-03, PNorm = 39.4957, GNorm = 1.2493, lr_0 = 4.1626e-04
Loss = 6.6187e-03, PNorm = 39.5103, GNorm = 2.2012, lr_0 = 4.0735e-04
Validation rmse = 1.356633
Epoch 17
Loss = 6.4486e-03, PNorm = 39.5266, GNorm = 0.6691, lr_0 = 3.9862e-04
Loss = 5.5827e-03, PNorm = 39.5425, GNorm = 0.4103, lr_0 = 3.9009e-04
Loss = 6.9050e-03, PNorm = 39.5575, GNorm = 1.0452, lr_0 = 3.8174e-04
Validation rmse = 1.403729
Epoch 18
Loss = 6.3550e-03, PNorm = 39.5763, GNorm = 1.5494, lr_0 = 3.7357e-04
Loss = 5.8544e-03, PNorm = 39.5927, GNorm = 0.7102, lr_0 = 3.6557e-04
Loss = 5.8991e-03, PNorm = 39.6012, GNorm = 1.8112, lr_0 = 3.5774e-04
Validation rmse = 1.281205
Epoch 19
Loss = 6.5778e-03, PNorm = 39.6179, GNorm = 0.5772, lr_0 = 3.5008e-04
Loss = 6.0306e-03, PNorm = 39.6307, GNorm = 0.6664, lr_0 = 3.4259e-04
Loss = 5.7590e-03, PNorm = 39.6423, GNorm = 0.6689, lr_0 = 3.3526e-04
Validation rmse = 1.299226
Epoch 20
Loss = 5.9840e-03, PNorm = 39.6534, GNorm = 0.8622, lr_0 = 3.2808e-04
Loss = 6.0672e-03, PNorm = 39.6659, GNorm = 2.6081, lr_0 = 3.2105e-04
Validation rmse = 1.284239
Epoch 21
Loss = 4.6252e-03, PNorm = 39.6802, GNorm = 0.9913, lr_0 = 3.1418e-04
Loss = 5.8990e-03, PNorm = 39.6939, GNorm = 0.6999, lr_0 = 3.0746e-04
Loss = 6.1850e-03, PNorm = 39.7016, GNorm = 1.1458, lr_0 = 3.0087e-04
Validation rmse = 1.352313
Epoch 22
Loss = 6.1062e-03, PNorm = 39.7119, GNorm = 0.7376, lr_0 = 2.9443e-04
Loss = 5.8670e-03, PNorm = 39.7226, GNorm = 0.9516, lr_0 = 2.8813e-04
Loss = 5.6510e-03, PNorm = 39.7301, GNorm = 0.9911, lr_0 = 2.8196e-04
Validation rmse = 1.186354
Epoch 23
Loss = 5.2616e-03, PNorm = 39.7432, GNorm = 0.6640, lr_0 = 2.7592e-04
Loss = 5.8697e-03, PNorm = 39.7493, GNorm = 0.9701, lr_0 = 2.7002e-04
Loss = 5.7040e-03, PNorm = 39.7607, GNorm = 1.0497, lr_0 = 2.6424e-04
Validation rmse = 1.266346
Epoch 24
Loss = 5.4462e-03, PNorm = 39.7685, GNorm = 1.0294, lr_0 = 2.5858e-04
Loss = 5.4377e-03, PNorm = 39.7797, GNorm = 0.8130, lr_0 = 2.5304e-04
Loss = 6.3216e-03, PNorm = 39.7887, GNorm = 0.7625, lr_0 = 2.4763e-04
Validation rmse = 1.214018
Epoch 25
Loss = 5.4460e-03, PNorm = 39.7971, GNorm = 1.7342, lr_0 = 2.4233e-04
Loss = 5.5789e-03, PNorm = 39.8046, GNorm = 0.5665, lr_0 = 2.3714e-04
Validation rmse = 1.346531
Epoch 26
Loss = 5.0131e-03, PNorm = 39.8141, GNorm = 1.1125, lr_0 = 2.3206e-04
Loss = 6.4626e-03, PNorm = 39.8223, GNorm = 1.5921, lr_0 = 2.2709e-04
Loss = 5.6659e-03, PNorm = 39.8291, GNorm = 0.7299, lr_0 = 2.2223e-04
Validation rmse = 1.217379
Epoch 27
Loss = 5.3297e-03, PNorm = 39.8377, GNorm = 0.6618, lr_0 = 2.1747e-04
Loss = 5.9127e-03, PNorm = 39.8462, GNorm = 1.1327, lr_0 = 2.1282e-04
Loss = 5.7323e-03, PNorm = 39.8546, GNorm = 0.9096, lr_0 = 2.0826e-04
Validation rmse = 1.244659
Epoch 28
Loss = 5.8649e-03, PNorm = 39.8601, GNorm = 1.2523, lr_0 = 2.0380e-04
Loss = 5.0894e-03, PNorm = 39.8680, GNorm = 0.4922, lr_0 = 1.9944e-04
Loss = 5.6566e-03, PNorm = 39.8753, GNorm = 0.8977, lr_0 = 1.9517e-04
Validation rmse = 1.294331
Epoch 29
Loss = 5.5202e-03, PNorm = 39.8818, GNorm = 0.5565, lr_0 = 1.9099e-04
Loss = 5.6339e-03, PNorm = 39.8871, GNorm = 1.0296, lr_0 = 1.8690e-04
Loss = 5.6706e-03, PNorm = 39.8926, GNorm = 1.5054, lr_0 = 1.8290e-04
Validation rmse = 1.399850
Epoch 30
Loss = 5.5884e-03, PNorm = 39.8999, GNorm = 1.1447, lr_0 = 1.7899e-04
Loss = 5.8725e-03, PNorm = 39.9093, GNorm = 1.1314, lr_0 = 1.7515e-04
Validation rmse = 1.291569
Epoch 31
Loss = 4.1337e-03, PNorm = 39.9120, GNorm = 0.8722, lr_0 = 1.7140e-04
Loss = 5.3039e-03, PNorm = 39.9188, GNorm = 1.9441, lr_0 = 1.6774e-04
Loss = 6.0126e-03, PNorm = 39.9242, GNorm = 2.3660, lr_0 = 1.6414e-04
Validation rmse = 1.419809
Epoch 32
Loss = 5.0957e-03, PNorm = 39.9306, GNorm = 0.6691, lr_0 = 1.6063e-04
Loss = 5.7258e-03, PNorm = 39.9345, GNorm = 1.2461, lr_0 = 1.5719e-04
Loss = 5.4123e-03, PNorm = 39.9393, GNorm = 0.9240, lr_0 = 1.5383e-04
Validation rmse = 1.300274
Epoch 33
Loss = 5.2423e-03, PNorm = 39.9441, GNorm = 0.9874, lr_0 = 1.5053e-04
Loss = 5.2927e-03, PNorm = 39.9495, GNorm = 0.7345, lr_0 = 1.4731e-04
Loss = 6.1596e-03, PNorm = 39.9555, GNorm = 0.7236, lr_0 = 1.4416e-04
Validation rmse = 1.366050
Epoch 34
Loss = 5.4888e-03, PNorm = 39.9596, GNorm = 0.8715, lr_0 = 1.4107e-04
Loss = 5.2071e-03, PNorm = 39.9649, GNorm = 1.1967, lr_0 = 1.3805e-04
Loss = 5.7336e-03, PNorm = 39.9688, GNorm = 0.9449, lr_0 = 1.3509e-04
Validation rmse = 1.309490
Epoch 35
Loss = 5.0527e-03, PNorm = 39.9729, GNorm = 0.7180, lr_0 = 1.3220e-04
Loss = 6.0967e-03, PNorm = 39.9752, GNorm = 1.8381, lr_0 = 1.2937e-04
Validation rmse = 1.408946
Epoch 36
Loss = 4.8376e-03, PNorm = 39.9817, GNorm = 0.6252, lr_0 = 1.2660e-04
Loss = 5.0083e-03, PNorm = 39.9856, GNorm = 0.9103, lr_0 = 1.2389e-04
Loss = 6.1160e-03, PNorm = 39.9907, GNorm = 1.0066, lr_0 = 1.2124e-04
Validation rmse = 1.353366
Epoch 37
Loss = 4.8587e-03, PNorm = 39.9936, GNorm = 0.7464, lr_0 = 1.1864e-04
Loss = 5.0193e-03, PNorm = 39.9968, GNorm = 0.7500, lr_0 = 1.1610e-04
Loss = 5.5530e-03, PNorm = 40.0011, GNorm = 1.4389, lr_0 = 1.1362e-04
Validation rmse = 1.292968
Epoch 38
Loss = 4.4547e-03, PNorm = 40.0043, GNorm = 1.0425, lr_0 = 1.1119e-04
Loss = 5.4902e-03, PNorm = 40.0067, GNorm = 1.4360, lr_0 = 1.0881e-04
Loss = 5.5199e-03, PNorm = 40.0114, GNorm = 1.7389, lr_0 = 1.0648e-04
Validation rmse = 1.269328
Epoch 39
Loss = 5.2762e-03, PNorm = 40.0151, GNorm = 1.8677, lr_0 = 1.0420e-04
Loss = 5.5677e-03, PNorm = 40.0180, GNorm = 1.3285, lr_0 = 1.0197e-04
Loss = 5.4762e-03, PNorm = 40.0217, GNorm = 0.5764, lr_0 = 1.0000e-04
Validation rmse = 1.310281
Model 0 best validation rmse = 1.030230 on epoch 7
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.803208
Ensemble test rmse = 0.803208
1-fold cross validation
Seed 5 ==> test rmse = 0.803208
Overall test rmse = 0.803208 +/- 0.000000
